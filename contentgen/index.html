<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LHL Content Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=DM+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #09090e;
  --surface: #111118;
  --surface2: #18181f;
  --surface3: #202028;
  --border: #252530;
  --border2: #353545;
  --text: #e4e4f0;
  --text2: #9090a8;
  --muted: #50506a;

  --ig: #E1306C;
  --ig-dim: rgba(225,48,108,0.10);
  --ig-border: rgba(225,48,108,0.25);
  --li: #0A66C2;
  --li-dim: rgba(10,102,194,0.10);
  --li-border: rgba(10,102,194,0.25);

  --c-edu: #4A9EFF;
  --c-social: #3ecf6a;
  --c-bts: #f59e0b;
  --c-pain: #ff5c35;
  --c-product: #a855f7;
  --c-thought: #06b6d4;
  --c-story: #f472b6;
  --c-lead: #10b981;

  --accent: #ff5c35;
  --success: #3ecf6a;
  --danger: #f87171;
}

*{margin:0;padding:0;box-sizing:border-box;}
html{scroll-behavior:smooth;}

body {
  font-family:'DM Sans',sans-serif;
  background:var(--bg);
  color:var(--text);
  min-height:100vh;
  overflow-x:hidden;
}

body::before {
  content:'';
  position:fixed;inset:0;
  background-image:
    linear-gradient(rgba(255,255,255,0.012) 1px,transparent 1px),
    linear-gradient(90deg,rgba(255,255,255,0.012) 1px,transparent 1px);
  background-size:40px 40px;
  pointer-events:none;z-index:0;
}

/* ‚îÄ‚îÄ‚îÄ LAYOUT ‚îÄ‚îÄ‚îÄ */
.shell{display:flex;min-height:100vh;position:relative;z-index:1;}

.sidebar{
  width:270px;min-width:270px;
  background:var(--surface);
  border-right:1px solid var(--border);
  display:flex;flex-direction:column;
  position:sticky;top:0;height:100vh;
  overflow-y:auto;flex-shrink:0;
}

.main{flex:1;min-width:0;display:flex;flex-direction:column;}

/* ‚îÄ‚îÄ‚îÄ SIDEBAR ‚îÄ‚îÄ‚îÄ */
.sb-logo{padding:20px 18px 14px;border-bottom:1px solid var(--border);}
.sb-logo h1{font-family:'Space Mono',monospace;font-size:14px;letter-spacing:-0.5px;}
.sb-logo h1 em{color:var(--accent);font-style:normal;}
.sb-logo p{font-size:10px;color:var(--muted);margin-top:3px;text-transform:uppercase;letter-spacing:.8px;}

.sb-tabs{display:flex;border-bottom:1px solid var(--border);}
.sb-tab{
  flex:1;padding:10px 6px;
  font-size:11px;font-weight:600;
  text-align:center;cursor:pointer;
  border-bottom:2px solid transparent;
  transition:all .15s;color:var(--text2);
  font-family:'DM Sans',sans-serif;
  background:none;border-top:none;border-left:none;border-right:none;
}
.sb-tab:hover{color:var(--text);}
.sb-tab.active.ig{color:var(--ig);border-bottom-color:var(--ig);}
.sb-tab.active.li{color:var(--li);border-bottom-color:var(--li);}

.sb-section{padding:14px 16px;border-bottom:1px solid var(--border);}
.sb-label{font-family:'Space Mono',monospace;font-size:9px;color:var(--muted);text-transform:uppercase;letter-spacing:1.5px;margin-bottom:10px;}

/* Pillar filters */
.pillar-list{display:flex;flex-direction:column;gap:4px;}
.pillar-row{
  display:flex;align-items:center;gap:7px;
  padding:6px 8px;border-radius:7px;
  border:1px solid transparent;cursor:pointer;
  background:none;color:var(--text2);font-size:11.5px;
  font-family:'DM Sans',sans-serif;font-weight:500;
  transition:all .15s;text-align:left;width:100%;
}
.pillar-row:hover{background:var(--surface2);color:var(--text);}
.pillar-row.on{background:var(--surface2);border-color:var(--border2);color:var(--text);}
.p-dot{width:7px;height:7px;border-radius:50%;flex-shrink:0;}
.p-count{margin-left:auto;font-family:'Space Mono',monospace;font-size:9px;color:var(--muted);}

/* Gen controls */
.gen-row{display:flex;flex-direction:column;gap:7px;}
.gsel{
  background:var(--surface2);border:1px solid var(--border);
  color:var(--text);padding:7px 10px;border-radius:7px;
  font-family:'DM Sans',sans-serif;font-size:12px;
  cursor:pointer;outline:none;width:100%;transition:border-color .2s;
}
.gsel:focus{border-color:var(--accent);}
.gbtn{
  background:var(--accent);color:white;border:none;
  padding:8px;border-radius:7px;
  font-family:'Space Mono',monospace;font-size:10px;
  cursor:pointer;transition:all .2s;width:100%;letter-spacing:.3px;
}
.gbtn:hover{background:#ff7055;box-shadow:0 4px 16px rgba(255,92,53,.3);}
.gbtn.li-btn{background:var(--li);}
.gbtn.li-btn:hover{background:#1a76d2;}

/* Idea chips */
.ideas-scroll{flex:1;overflow-y:auto;padding:10px 12px 20px;}
.no-ideas{font-size:11px;color:var(--muted);text-align:center;padding:16px 0;}

.chip{
  background:var(--surface2);border:1px solid var(--border);
  border-radius:8px;padding:10px 11px;
  cursor:grab;transition:all .15s;
  animation:fadeUp .3s ease both;
  margin-bottom:7px;
}
.chip:hover{border-color:var(--border2);box-shadow:0 2px 12px rgba(0,0,0,.3);}
.chip:active{cursor:grabbing;}
.chip.ig-chip:hover{border-color:var(--ig);}
.chip.li-chip:hover{border-color:var(--li);}
.chip-meta{font-family:'Space Mono',monospace;font-size:8.5px;text-transform:uppercase;letter-spacing:.4px;margin-bottom:3px;}
.chip-title{font-size:11.5px;font-weight:600;line-height:1.35;color:var(--text);}
.chip-hook{font-size:10.5px;color:var(--text2);line-height:1.4;margin-top:3px;}
.chip-add{
  margin-top:7px;background:none;
  border:1px solid var(--border);color:var(--text2);
  font-size:9.5px;font-family:'Space Mono',monospace;
  padding:4px 8px;border-radius:5px;cursor:pointer;
  transition:all .15s;width:100%;
}
.chip-add:hover{border-color:var(--accent);color:var(--accent);}
.chip-add.li-add:hover{border-color:var(--li);color:var(--li);}

/* ‚îÄ‚îÄ‚îÄ MAIN ‚îÄ‚îÄ‚îÄ */
.top-bar{
  padding:18px 24px 0;
  display:flex;align-items:center;justify-content:space-between;
  flex-wrap:wrap;gap:10px;
}

.month-nav{
  display:flex;align-items:center;gap:8px;
  background:var(--surface);border:1px solid var(--border);
  border-radius:8px;padding:8px 14px;
}
.month-nav button{
  background:none;border:none;color:var(--muted);
  cursor:pointer;font-size:15px;font-family:'Space Mono',monospace;
  transition:color .15s;
}
.month-nav button:hover{color:var(--accent);}
.month-label{font-family:'Space Mono',monospace;font-size:12px;min-width:130px;text-align:center;}

.top-actions{display:flex;gap:7px;flex-wrap:wrap;}
.btn-sm{
  background:var(--surface);border:1px solid var(--border);
  color:var(--text2);padding:7px 13px;border-radius:7px;
  font-size:11px;font-family:'DM Sans',sans-serif;
  cursor:pointer;transition:all .15s;white-space:nowrap;
}
.btn-sm:hover{border-color:var(--border2);color:var(--text);}
.btn-sm.ig:hover{border-color:var(--ig);color:var(--ig);}
.btn-sm.li:hover{border-color:var(--li);color:var(--li);}

/* Platform legend */
.plat-legend{
  display:flex;gap:14px;align-items:center;
  padding:10px 24px 0;flex-wrap:wrap;
}
.plat-badge{
  display:flex;align-items:center;gap:5px;
  font-size:11px;font-weight:600;
  padding:4px 10px;border-radius:999px;cursor:pointer;
  border:1px solid transparent;transition:all .15s;
  background:none;font-family:'DM Sans',sans-serif;
}
.plat-badge.ig{color:var(--ig);border-color:var(--ig-border);background:var(--ig-dim);}
.plat-badge.li{color:var(--li);border-color:var(--li-border);background:var(--li-dim);}
.plat-badge.off{opacity:.35;}
.plat-dot{width:7px;height:7px;border-radius:50%;}

/* ‚îÄ‚îÄ‚îÄ CALENDAR ‚îÄ‚îÄ‚îÄ */
.cal-wrap{padding:14px 24px 32px;flex:1;}

.day-headers{
  display:grid;grid-template-columns:repeat(7,1fr);
  gap:6px;margin-bottom:5px;
}
.dh{
  text-align:center;font-family:'Space Mono',monospace;
  font-size:9px;color:var(--muted);
  text-transform:uppercase;letter-spacing:1px;padding:3px;
}

.cal-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:6px;}

.cal-cell{
  background:var(--surface);border:1px solid var(--border);
  border-radius:11px;min-height:110px;
  padding:8px 7px;display:flex;flex-direction:column;gap:4px;
  transition:border-color .15s;position:relative;
}
.cal-cell.today{border-color:var(--accent);}
.cal-cell.today .cell-num{color:var(--accent);}
.cal-cell.other-month{opacity:.35;}
.cal-cell.drop-ig{border-color:var(--ig);background:var(--ig-dim);}
.cal-cell.drop-li{border-color:var(--li);background:var(--li-dim);}

.cell-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:1px;}
.cell-num{font-family:'Space Mono',monospace;font-size:10px;color:var(--muted);}
.cell-add{
  background:none;border:none;color:var(--muted);
  cursor:pointer;font-size:13px;line-height:1;
  opacity:0;transition:opacity .15s color .15s;padding:0 2px;
}
.cal-cell:hover .cell-add{opacity:1;}
.cell-add:hover{color:var(--accent);}

/* Post pills */
.post-pill{
  border-radius:6px;padding:5px 7px;
  border:1px solid transparent;cursor:pointer;
  transition:filter .15s;position:relative;
  display:flex;align-items:flex-start;gap:5px;
}
.post-pill:hover{filter:brightness(1.15);}
.post-pill.ig-pill{background:var(--ig-dim);border-color:var(--ig-border);}
.post-pill.li-pill{background:var(--li-dim);border-color:var(--li-border);}

.pill-plat{font-size:9px;flex-shrink:0;margin-top:1px;}
.pill-body{flex:1;min-width:0;}
.pill-format{font-family:'Space Mono',monospace;font-size:7.5px;text-transform:uppercase;letter-spacing:.4px;opacity:.7;margin-bottom:1px;}
.pill-title{font-size:10px;font-weight:600;line-height:1.3;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.pill-author{font-size:8.5px;color:var(--text2);margin-top:1px;}

.pill-acts{
  display:none;position:absolute;top:3px;right:3px;gap:2px;
}
.post-pill:hover .pill-acts{display:flex;}
.pill-act{
  background:rgba(0,0,0,.55);border:none;color:white;
  width:16px;height:16px;border-radius:3px;cursor:pointer;
  font-size:8px;display:flex;align-items:center;justify-content:center;
  transition:background .15s;
}
.pill-act:hover{background:var(--accent);}
.pill-act.del:hover{background:var(--danger);}

.empty-drop{
  flex:1;border:1px dashed var(--border);
  border-radius:6px;display:flex;align-items:center;
  justify-content:center;color:var(--muted);
  font-size:16px;cursor:pointer;min-height:36px;
  transition:all .15s;
}
.empty-drop:hover{border-color:var(--accent);color:var(--accent);background:rgba(255,92,53,.06);}

/* ‚îÄ‚îÄ‚îÄ HASHTAG ‚îÄ‚îÄ‚îÄ */
.ht-section{
  margin:0 24px 32px;
  background:var(--surface);border:1px solid var(--border);
  border-radius:12px;padding:18px 20px;
}
.ht-tabs{display:flex;gap:6px;margin-bottom:14px;}
.ht-tab{
  padding:5px 12px;border-radius:999px;font-size:11px;font-weight:600;
  cursor:pointer;border:1px solid var(--border);background:none;
  color:var(--text2);transition:all .15s;font-family:'DM Sans',sans-serif;
}
.ht-tab.active.ig{background:var(--ig-dim);border-color:var(--ig-border);color:var(--ig);}
.ht-tab.active.li{background:var(--li-dim);border-color:var(--li-border);color:var(--li);}
.ht-groups{display:flex;flex-wrap:wrap;gap:16px;}
.ht-group h4{font-family:'Space Mono',monospace;font-size:9px;color:var(--muted);text-transform:uppercase;letter-spacing:1px;margin-bottom:7px;}
.ht-tags{display:flex;flex-wrap:wrap;gap:4px;}
.htag{
  font-size:10.5px;color:var(--text2);
  background:var(--surface2);border:1px solid var(--border);
  border-radius:4px;padding:3px 8px;
  font-family:'Space Mono',monospace;
  cursor:pointer;transition:all .15s;user-select:none;
}
.htag:hover{border-color:var(--accent);color:var(--accent);}
.htag.copied{border-color:var(--success);color:var(--success);}

/* ‚îÄ‚îÄ‚îÄ OVERLAYS ‚îÄ‚îÄ‚îÄ */
.overlay{
  position:fixed;inset:0;
  background:rgba(0,0,0,.78);backdrop-filter:blur(8px);
  z-index:200;display:none;align-items:center;justify-content:center;
  padding:16px;
}
.overlay.open{display:flex;animation:fadeIn .15s ease;}

.modal{
  background:var(--surface);border:1px solid var(--border);
  border-radius:14px;padding:24px;
  width:100%;max-width:500px;position:relative;
  max-height:92vh;overflow-y:auto;
}
.modal-x{
  position:absolute;top:12px;right:12px;
  background:none;border:none;color:var(--muted);
  font-size:17px;cursor:pointer;transition:color .15s;
}
.modal-x:hover{color:var(--accent);}
.modal h2{font-family:'Space Mono',monospace;font-size:14px;margin-bottom:18px;line-height:1.4;padding-right:28px;}

.fld{margin-bottom:12px;}
.fld label{display:block;font-size:9px;color:var(--muted);text-transform:uppercase;letter-spacing:.5px;margin-bottom:4px;font-family:'Space Mono',monospace;}
.fld input,.fld textarea,.fld select{
  width:100%;background:var(--surface2);border:1px solid var(--border);
  color:var(--text);padding:8px 11px;border-radius:8px;
  font-family:'DM Sans',sans-serif;font-size:12.5px;
  outline:none;transition:border-color .2s;resize:vertical;
}
.fld input:focus,.fld textarea:focus,.fld select:focus{border-color:var(--accent);}
.fld textarea{min-height:72px;}

.fld-row{display:grid;grid-template-columns:1fr 1fr;gap:10px;}

.modal-actions{display:flex;gap:8px;margin-top:18px;}
.btn-primary{
  flex:1;background:var(--accent);color:white;
  border:none;padding:10px;border-radius:8px;
  font-family:'Space Mono',monospace;font-size:10px;
  cursor:pointer;transition:all .15s;
}
.btn-primary:hover{background:#ff7055;}
.btn-primary.li-btn{background:var(--li);}
.btn-primary.li-btn:hover{background:#1a76d2;}
.btn-ghost{
  background:none;border:1px solid var(--border);color:var(--text2);
  padding:10px 14px;border-radius:8px;
  font-family:'Space Mono',monospace;font-size:10px;
  cursor:pointer;transition:all .15s;
}
.btn-ghost:hover{border-color:var(--border2);color:var(--text);}

/* Day picker */
.dp-grid{
  display:grid;
  grid-template-columns:auto repeat(7,1fr);
  gap:5px;margin:8px 0 14px;
}
.dp-wk{font-family:'Space Mono',monospace;font-size:8px;color:var(--muted);align-self:center;padding-right:4px;}
.dp-dh{text-align:center;font-family:'Space Mono',monospace;font-size:8px;color:var(--muted);text-transform:uppercase;}
.dp-btn{
  background:var(--surface2);border:1px solid var(--border);
  color:var(--text2);padding:7px 3px;border-radius:6px;
  font-family:'Space Mono',monospace;font-size:9px;
  cursor:pointer;transition:all .15s;text-align:center;
}
.dp-btn:hover:not(:disabled){border-color:var(--accent);color:var(--accent);}
.dp-btn:disabled{opacity:.2;cursor:not-allowed;}
.dp-btn.sel{background:var(--accent);border-color:var(--accent);color:white;}
.dp-btn.today-dp{border-color:var(--accent);}
.dp-btn.has-post{color:var(--text);}

/* Detail */
.det-label{font-family:'Space Mono',monospace;font-size:9px;color:var(--muted);text-transform:uppercase;letter-spacing:.5px;margin:12px 0 4px;}
.det-block{background:var(--surface2);border:1px solid var(--border);border-radius:7px;padding:10px 12px;font-size:12px;line-height:1.7;font-style:italic;}

/* Notify */
.notify{
  position:fixed;bottom:20px;right:20px;
  background:var(--surface2);border:1px solid var(--border);
  border-radius:9px;padding:10px 16px;font-size:12px;
  z-index:300;transform:translateY(70px);opacity:0;
  transition:all .3s ease;pointer-events:none;
}
.notify.show{transform:translateY(0);opacity:1;}
.notify.ok{border-color:var(--success);color:var(--success);}
.notify.err{border-color:var(--danger);color:var(--danger);}

@keyframes fadeIn{from{opacity:0;transform:translateY(5px)}to{opacity:1;transform:translateY(0)}}
@keyframes fadeUp{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}

::-webkit-scrollbar{width:3px;}
::-webkit-scrollbar-track{background:var(--bg);}
::-webkit-scrollbar-thumb{background:var(--border);border-radius:2px;}
</style>
</head>
<body>
<div class="shell">

<!-- ‚ïê‚ïê‚ïê SIDEBAR ‚ïê‚ïê‚ïê -->
<aside class="sidebar">
  <div class="sb-logo">
    <h1>Little<em>Hammer</em>Labs</h1>
    <p>Content Dashboard</p>
  </div>

  <div class="sb-tabs">
    <button class="sb-tab active ig" onclick="switchSbTab('ig',this)">üì∏ Instagram</button>
    <button class="sb-tab li" onclick="switchSbTab('li',this)">üíº LinkedIn</button>
  </div>

  <!-- Pillar filters -->
  <div class="sb-section">
    <div class="sb-label" id="pillarSectionLabel">IG Pillars</div>
    <div class="pillar-list" id="pillarList"></div>
  </div>

  <!-- Idea generator -->
  <div class="sb-section">
    <div class="sb-label" id="genLabel">Generate IG Ideas</div>
    <div class="gen-row">
      <select class="gsel" id="genPillar"><option value="all">All Pillars</option></select>
      <select class="gsel" id="genFormat">
        <option value="all">All Formats</option>
      </select>
      <select class="gsel" id="genAuthor" style="display:none">
        <option value="all">Ryan or Max</option>
        <option value="ryan">Ryan (Engineering)</option>
        <option value="max">Max (Operations)</option>
        <option value="company">LHL Company Page</option>
      </select>
      <button class="gbtn" id="genBtn" onclick="generateIdeas()">‚ö° Generate Ideas</button>
    </div>
  </div>

  <div class="ideas-scroll" id="ideaScroll">
    <p class="no-ideas">Hit Generate to get ideas</p>
  </div>
</aside>

<!-- ‚ïê‚ïê‚ïê MAIN ‚ïê‚ïê‚ïê -->
<main class="main">
  <div class="top-bar">
    <div class="month-nav">
      <button onclick="changeMonth(-1)">‚Üê</button>
      <span class="month-label" id="monthLabel"></span>
      <button onclick="changeMonth(1)">‚Üí</button>
    </div>
    <div class="top-actions">
      <button class="btn-sm ig" onclick="openAdd('ig',null,null)">+ IG Post</button>
      <button class="btn-sm li" onclick="openAdd('li',null,null)">+ LinkedIn Post</button>
      <button class="btn-sm" onclick="exportCSV()">Export CSV</button>
    </div>
  </div>

  <div class="plat-legend">
    <button class="plat-badge ig" id="legendIG" onclick="togglePlatVis('ig')">
      <div class="plat-dot" style="background:var(--ig)"></div> Instagram
    </button>
    <button class="plat-badge li" id="legendLI" onclick="togglePlatVis('li')">
      <div class="plat-dot" style="background:var(--li)"></div> LinkedIn
    </button>
    <span style="font-size:10px;color:var(--muted);margin-left:4px">Drag ideas onto any date ¬∑ Click a post to view</span>
  </div>

  <div class="cal-wrap">
    <div class="day-headers" id="dayHeaders"></div>
    <div class="cal-grid" id="calGrid"></div>
  </div>

  <div class="ht-section">
    <div class="ht-tabs">
      <button class="ht-tab active ig" onclick="switchHtTab('ig',this)">Instagram Tags</button>
      <button class="ht-tab li" onclick="switchHtTab('li',this)">LinkedIn Tags</button>
    </div>
    <div class="ht-groups" id="htGroups"></div>
  </div>
</main>
</div>

<!-- ‚îÄ‚îÄ‚îÄ ADD/EDIT MODAL ‚îÄ‚îÄ‚îÄ -->
<div class="overlay" id="editOverlay" onclick="closeOvl('editOverlay',event)">
<div class="modal">
  <button class="modal-x" onclick="closeOvl('editOverlay')">‚úï</button>
  <h2 id="editModalTitle">Add Post</h2>
  <div class="fld">
    <label>Platform</label>
    <select id="fPlat" onchange="onPlatChange()">
      <option value="ig">üì∏ Instagram</option>
      <option value="li">üíº LinkedIn</option>
    </select>
  </div>
  <div class="fld-row">
    <div class="fld">
      <label>Pillar</label>
      <select id="fPillar"></select>
    </div>
    <div class="fld">
      <label>Format</label>
      <select id="fFormat"></select>
    </div>
  </div>
  <div class="fld" id="authorField" style="display:none">
    <label>Author</label>
    <select id="fAuthor">
      <option value="Ryan">Ryan (Engineering)</option>
      <option value="Max">Max (Operations)</option>
      <option value="LHL">LHL Company Page</option>
    </select>
  </div>
  <div class="fld">
    <label>Title / Idea</label>
    <input type="text" id="fTitle" placeholder="Post title or topic">
  </div>
  <div class="fld">
    <label>Hook / Opening Line</label>
    <textarea id="fHook" placeholder="The first sentence of your caption..."></textarea>
  </div>
  <div class="fld">
    <label>Content Notes</label>
    <textarea id="fBody" placeholder="Talking points, slide breakdown, visual direction..."></textarea>
  </div>
  <div class="fld">
    <label>Hashtags (comma separated)</label>
    <input type="text" id="fTags" placeholder="#AIAgents, #BusinessAutomation">
  </div>

  <!-- Day picker -->
  <div id="dpWrap">
    <div class="fld" style="margin-bottom:6px"><label>Schedule ‚Äî pick a date</label></div>
    <div id="dpGrid" class="dp-grid"></div>
  </div>

  <div class="modal-actions">
    <button class="btn-ghost" onclick="closeOvl('editOverlay')">Cancel</button>
    <button class="btn-primary" id="savePrimary" onclick="savePost()">Save Post</button>
  </div>
</div>
</div>

<!-- ‚îÄ‚îÄ‚îÄ DETAIL MODAL ‚îÄ‚îÄ‚îÄ -->
<div class="overlay" id="detailOverlay" onclick="closeOvl('detailOverlay',event)">
<div class="modal">
  <button class="modal-x" onclick="closeOvl('detailOverlay')">‚úï</button>
  <h2 id="detailTitle"></h2>
  <div id="detailBody"></div>
  <div class="modal-actions">
    <button class="btn-ghost" onclick="editFromDetail()">‚úè Edit</button>
    <button class="btn-primary" id="copyBtn" onclick="copyCaption()">Copy Caption</button>
  </div>
</div>
</div>

<div class="notify" id="notify"></div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DATA
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

const IG_PILLARS = [
  {id:'edu',    label:'Education',         color:'#4A9EFF'},
  {id:'social', label:'Social Proof',      color:'#3ecf6a'},
  {id:'bts',    label:'Behind the Scenes', color:'#f59e0b'},
  {id:'pain',   label:'Pain Points',       color:'#ff5c35'},
  {id:'product',label:'Product/Feature',   color:'#a855f7'},
];

const LI_PILLARS = [
  {id:'thought',label:'Thought Leadership', color:'#06b6d4'},
  {id:'story',  label:'Personal Story',     color:'#f472b6'},
  {id:'lead',   label:'Lead Generation',    color:'#10b981'},
  {id:'edu',    label:'Education',          color:'#4A9EFF'},
  {id:'bts',    label:'Behind the Scenes',  color:'#f59e0b'},
];

const IG_FORMATS = ['Reel','Carousel','Static','Story'];
const LI_FORMATS = ['Text Post','Carousel','Article','Poll','Video'];

const IG_IDEAS = [
  {pillar:'edu',    format:'Carousel', title:'"What IS an AI Agent?" explainer',           hook:'Everyone says AI. Most people mean chatbot. Here\'s the actual difference üëá',                                   body:'Slide 1: Chatbot vs Agent. Slide 2: Chatbot answers ‚Äî Agent acts. Slide 3: Friday 5:30pm scenario. Slide 4: 3 components of an agent. Slide 5: CTA.',              hashtags:'#AIAgents,#BusinessAutomation,#AIForBusiness'},
  {pillar:'edu',    format:'Reel',     title:'60-sec: AI that reads your CRM',              hook:'We built an AI that reads your CRM, emails, and files ‚Äî and acts on all three.',                               body:'Screen recording walkthrough. Email ‚Üí CRM pull ‚Üí response generated ‚Üí logged. Under 60 seconds.',                                                                  hashtags:'#AIDemo,#CRMAutomation,#SmallBusiness'},
  {pillar:'edu',    format:'Carousel', title:'5 signs your team needs an AI agent',         hook:'Not every business needs an AI agent right now. But here are 5 signs yours does.',                            body:'1. Same questions 20x/wk. 2. Manual follow-up losing leads. 3. Data in 3 tools. 4. After-hours gaps. 5. Team drowning in admin.',                                hashtags:'#BusinessEfficiency,#AIStrategy,#OperationsManagement'},
  {pillar:'edu',    format:'Static',   title:'"LLM vs AI Agent" comparison graphic',        hook:'A language model talks. An agent does.',                                                                        body:'Bold split graphic. Left = LLM (text only). Right = Agent (actions, tools, multi-step). Branded in LHL colors.',                                                  hashtags:'#LLM,#AIAgents,#MachineLearning'},
  {pillar:'edu',    format:'Reel',     title:'Private LLM explained in 60 seconds',         hook:'Your data shouldn\'t live on someone else\'s servers.',                                                         body:'Diagram: data ‚Üí private model ‚Üí output. Zero public API exposure. "We build these in 2-4 weeks."',                                                                 hashtags:'#DataPrivacy,#PrivateAI,#AICompliance'},
  {pillar:'social', format:'Carousel', title:'Diehl Group Architects case study',            hook:'An architecture firm was drowning in manual transcription. We fixed that.',                                    body:'Problem ‚Üí solution (AI transcription tool) ‚Üí result (hours saved/week) ‚Üí quote ‚Üí CTA. 5 slides.',                                                                   hashtags:'#ClientWin,#AIForArchitects,#BusinessAutomation'},
  {pillar:'social', format:'Static',   title:'"Before / After" workflow visual',             hook:'Before: 4-day response. After: Under 1 hour. Same team. Smarter tools.',                                      body:'Split: manual process vs agent process. Clean, bold, highly shareable.',                                                                                            hashtags:'#AIResults,#WorkflowAutomation,#Productivity'},
  {pillar:'social', format:'Reel',     title:'Founding Partner Program spotlight',           hook:'We\'re only working with a handful of founding partners. Here\'s what that looks like.',                       body:'Ryan and Max on camera. What it includes, why it\'s limited, what businesses get. Authentic, no script.',                                                           hashtags:'#FoundingPartner,#StartupLife,#AIStartup'},
  {pillar:'bts',    format:'Reel',     title:'Why we started LHL',                          hook:'We kept seeing the same problem ‚Äî businesses drowning in work AI could handle.',                               body:'Casual talking head, San Diego backdrop. Origin story, honest and conversational.',                                                                                 hashtags:'#Founders,#StartupStory,#SanDiego'},
  {pillar:'bts',    format:'Static',   title:'Our tech stack',                              hook:'What\'s powering our agents? Here\'s the stack.',                                                               body:'Logo lockup: Claude ‚Üí LangChain ‚Üí Python/Node ‚Üí Private cloud ‚Üí Client tools. "We don\'t do off-the-shelf."',                                                       hashtags:'#TechStack,#LangChain,#AnthropicClaude'},
  {pillar:'bts',    format:'Reel',     title:'A day in the life: building an agent',        hook:'What does it actually look like to build a custom AI agent?',                                                   body:'Discovery notes ‚Üí design ‚Üí testing ‚Üí client review ‚Üí deploy. Fast cuts, engaging VO.',                                                                             hashtags:'#BuildInPublic,#AIEngineering,#DayInTheLife'},
  {pillar:'bts',    format:'Story',    title:'Poll: What\'s your biggest time drain?',      hook:'We\'re always curious ‚Äî what eats your team\'s time most?',                                                    body:'Story poll: A) Email & follow-ups  B) Data entry  C) Client requests  D) Scheduling. DM respondents.',                                                            hashtags:''},
  {pillar:'pain',   format:'Static',   title:'"Your team answers the same email 40x/week"', hook:'Your smartest people are copy-pasting the same answer. Over and over.',                                        body:'Bold typographic post. Dark bg, white text. One stat. No fluff. CTA in caption.',                                                                                  hashtags:'#BusinessProblem,#Automation,#OperationsLeader'},
  {pillar:'pain',   format:'Carousel', title:'"The real cost of manual processes"',         hook:'You\'re probably not tracking this. But the math is brutal.',                                                  body:'40% of worker time = repetitive tasks. $60k salary ‚Üí $24k/yr wasted. 5 employees = $120k. AI agent costs a fraction. CTA.',                                       hashtags:'#ROI,#BusinessCosts,#AIInvestment'},
  {pillar:'pain',   format:'Reel',     title:'"Why your team hates Monday mornings"',       hook:'It\'s not the meetings. It\'s the inbox full of stuff that piled up Friday at 5pm.',                           body:'Relatable hook ‚Üí pivot to agent workflow. CTA to book a call.',                                                                                                    hashtags:'#WorkLifeBalance,#SmallBusinessProblems,#AIHelp'},
  {pillar:'pain',   format:'Carousel', title:'"Why your chatbot isn\'t working"',           hook:'You tried a chatbot. It answered FAQs. Your team is still drowning. Here\'s why.',                             body:'5 slides: chatbot limitations vs agent capabilities. End: "You don\'t need a chatbot. You need an agent."',                                                         hashtags:'#Chatbot,#AIAgent,#DigitalTransformation'},
  {pillar:'product',format:'Reel',     title:'Live demo: agent handles a request end-to-end',hook:'Watch this AI agent handle a full client request ‚Äî no human touch required.',                                  body:'Screen recording + VO. Email ‚Üí classify ‚Üí CRM pull ‚Üí draft ‚Üí log ‚Üí send. Real workflow, 90 seconds.',                                                              hashtags:'#AIDemo,#LiveDemo,#AutomationTool'},
  {pillar:'product',format:'Carousel', title:'"3 agents we\'ve built this quarter"',        hook:'Every agent we build is different. Here are 3 from this quarter.',                                             body:'Diehl transcription. Lead follow-up automation. Document processing. Each: client type ‚Üí problem ‚Üí build ‚Üí result.',                                               hashtags:'#CustomAI,#AIBuilds,#AgentShowcase'},
  {pillar:'product',format:'Static',   title:'Pilot program explainer',                     hook:'2‚Äì4 weeks. One workflow. Real results before you commit.',                                                      body:'Discovery (free) ‚Üí Pilot ‚Üí Deploy ‚Üí Optimize. Clean infographic. Simple and confident.',                                                                          hashtags:'#LowRiskAI,#AIForSMB,#TechConsulting'},
];

const LI_IDEAS = [
  // Thought Leadership
  {pillar:'thought',format:'Text Post', author:'Ryan', title:'Why most AI implementations fail',              hook:'I\'ve seen dozens of businesses try to add AI and fail. It\'s almost never the technology. It\'s the process.\n\nHere\'s what actually goes wrong:',                                           body:'3-5 numbered points. End with: "The businesses that win with AI don\'t buy AI tools. They redesign workflows first." CTA: What\'s your experience?',                   hashtags:'#AIImplementation,#DigitalTransformation,#BusinessStrategy'},
  {pillar:'thought',format:'Text Post', author:'Max',  title:'The workflow audit that changed how we work',    hook:'Before we build a single line of agent code, we spend 30 minutes on a free discovery call.\n\nMost clients think they need automation. What they actually need is clarity.',               body:'Walk through the audit process. What questions you ask. What surprises come up. The "a-ha" moments. End with: "Book a free one for your business ‚Üí [link]"',           hashtags:'#BusinessOperations,#Consulting,#AIStrategy'},
  {pillar:'thought',format:'Text Post', author:'Ryan', title:'"Agentic AI" is being overused. Here\'s the real definition.', hook:'Everyone\'s calling their product an "AI agent" now.\n\nHere\'s what an actual agent requires ‚Äî and why most tools don\'t qualify:',                                          body:'1. Memory/context. 2. Tool use/actions. 3. Goal-directed behavior. 4. Autonomy. Most "agents" are fancy chatbots. Call out the difference clearly.',                  hashtags:'#AIAgents,#LLM,#ArtificialIntelligence,#TechLeadership'},
  {pillar:'thought',format:'Carousel', author:'Ryan', title:'5 things I\'ve learned after building AI agents for real businesses', hook:'We\'ve been building custom AI agents for businesses for a while now. Here\'s what nobody tells you about the process.',                                                   body:'Slide 1: Discovery is harder than engineering. Slide 2: Integration beats intelligence. Slide 3: Trust takes time. Slide 4: The first win matters most. Slide 5: Expand slowly.',  hashtags:'#AIEngineering,#BuildInPublic,#StartupLessons'},
  {pillar:'thought',format:'Text Post', author:'Max',  title:'The Friday 5:30pm test for your business',       hook:'Here\'s a simple test to tell if AI can help your business:\n\nA high-priority request comes in Friday at 5:30pm.\n\nWhat happens?',                                                          body:'Walk through the two scenarios (manual vs agent). Make it vivid. End with: "If your answer was \'it waits until Monday\' ‚Äî we should talk." CTA link.',                hashtags:'#BusinessEfficiency,#CustomerExperience,#AIForBusiness'},
  {pillar:'thought',format:'Poll',     author:'Ryan', title:'Poll: What\'s your AI readiness?',                hook:'Quick question for the operations/engineering leaders in my network:',                                                                                                                         body:'Poll: Where is your company with AI? A) Still evaluating  B) Using off-the-shelf tools  C) Custom solutions  D) Fully integrated. Plan follow-up post based on results.',hashtags:'#AIStrategy,#DigitalTransformation,#Poll'},
  // Personal Story
  {pillar:'story',  format:'Text Post', author:'Ryan', title:'Why I left [previous role] to build AI agents',   hook:'A year ago I was [doing X]. Today I\'m building custom AI systems for businesses that most people thought were impossible to automate.\n\nHere\'s what changed my mind:',                body:'Honest personal narrative. What you saw broken. Why off-the-shelf wasn\'t enough. Why LHL exists. Vulnerable and direct.',                                             hashtags:'#FounderStory,#Entrepreneurship,#AIStartup,#SanDiego'},
  {pillar:'story',  format:'Text Post', author:'Max',  title:'The client meeting that changed how we pitch',    hook:'We almost lost a client in the first 10 minutes of our discovery call.\n\nNot because our product wasn\'t good. Because we were answering the wrong question.',                           body:'Story of realizing clients don\'t want to know how it works ‚Äî they want to know what it fixes. Pivot to outcome-first selling. Practical lesson for anyone in B2B sales.',hashtags:'#SalesStrategy,#B2B,#FounderLife,#Consulting'},
  {pillar:'story',  format:'Text Post', author:'Ryan', title:'What building LHL taught me about automation',   hook:'The hardest thing about building AI agents isn\'t the AI.\n\nIt\'s convincing people to trust it.',                                                                                           body:'Reflect on the trust curve. First demos. First handoffs. First client who let it run autonomously. What built confidence.',                                              hashtags:'#AITrust,#ChangeManagement,#TechStartup'},
  // Lead Gen
  {pillar:'lead',   format:'Text Post', author:'Max',  title:'Free workflow audit offer',                      hook:'If your team is spending more than 2 hours a day on repetitive tasks, I\'ll spend 30 minutes with you showing exactly where AI can cut that in half.\n\nNo pitch. No obligation.',          body:'What the audit covers: workflow mapping, bottleneck identification, ROI estimate. What you leave with. How to book. Direct CTA with link.',                             hashtags:'#FreeConsultation,#AIConsulting,#SmallBusiness,#WorkflowAudit'},
  {pillar:'lead',   format:'Text Post', author:'Ryan', title:'Who our founding partner program is for',        hook:'We\'re working with a small group of businesses to build their first AI agent at founding partner pricing.\n\nHere\'s exactly who this is for (and who it\'s NOT for):',                  body:'Ideal: SMBs with repetitive workflows, open to new tech, need 24/7 coverage. Not ideal: enterprise with procurement cycles, want off-the-shelf. Direct and honest.',    hashtags:'#FoundingPartner,#AIAgents,#StartupLife'},
  {pillar:'lead',   format:'Carousel', author:'Max',  title:'"Is AI automation right for my business?" checklist', hook:'Not sure if now is the right time to invest in AI automation?\n\nHere\'s an honest checklist to help you decide:',                                                                     body:'5 slides: Budget threshold. Team size. Workflow repetitiveness score. Data availability. Leadership buy-in. Score yourself. End with: "If you scored 3+, let\'s talk."', hashtags:'#AIReadiness,#BusinessAutomation,#DecisionMaking'},
  {pillar:'lead',   format:'Text Post', author:'Ryan', title:'What our pilot program actually looks like',     hook:'People often ask: "What do I actually get in the 2-4 week pilot?"\n\nHere\'s exactly what happens week by week:',                                                                           body:'Week 1: Discovery + design. Week 2: Build + internal testing. Week 3: Client environment testing. Week 4: Deploy + training. "You see it working before spending more."', hashtags:'#AIImplementation,#Pilot,#TechConsulting,#LittleHammerLabs'},
  // Education (LI)
  {pillar:'edu',    format:'Text Post', author:'Ryan', title:'Private LLM vs public API: a plain-English breakdown', hook:'Most businesses don\'t realize how much control they\'re giving up when they connect their data to a public AI API.\n\nHere\'s what actually happens to your data:',               body:'Public API: data leaves your servers, used for training, no guarantees. Private/local LLM: data stays with you, full control, zero exposure. When each makes sense.',   hashtags:'#DataPrivacy,#LLM,#AICompliance,#EnterpriseAI'},
  {pillar:'edu',    format:'Carousel', author:'Max',  title:'How to evaluate an AI vendor (what to ask)',     hook:'Not all AI vendors are equal. Most will tell you what you want to hear.\n\nHere are the 6 questions you should ask before signing anything:',                                              body:'1. Where does our data go? 2. What happens if it\'s wrong? 3. What does integration actually require? 4. How do you measure success? 5. What does offboarding look like? 6. References?', hashtags:'#AIVendors,#DueDiligence,#TechProcurement'},
  // BTS (LI)
  {pillar:'bts',    format:'Text Post', author:'Ryan', title:'What our tech stack looks like (and why)',       hook:'People ask what we actually build on. Here\'s our stack ‚Äî and the reason behind every choice:',                                                                                             body:'Claude (Anthropic) for reasoning. LangChain for orchestration. Python + Node.js for flexibility. Local hardware + cloud GPU hybrid. Lean and cost-effective by design.',  hashtags:'#TechStack,#AIEngineering,#LangChain,#Anthropic'},
  {pillar:'bts',    format:'Text Post', author:'Max',  title:'What a real discovery call looks like',         hook:'Our free discovery call isn\'t a sales call.\n\nHere\'s exactly what we do in those 30 minutes ‚Äî and what you leave with:',                                                               body:'Workflow mapping exercise. Bottleneck identification. ROI back-of-envelope. Honest assessment of whether we\'re the right fit. "We turn away clients who aren\'t ready."', hashtags:'#ConsultingLife,#DiscoveryCall,#AIConsulting,#SanDiego'},
];

const IG_HASHTAGS = [
  {group:'Core',     tags:['#LittleHammerLabs','#AIAgents','#CustomAI','#PrivateAI','#AgenticAI']},
  {group:'Industry', tags:['#BusinessAutomation','#WorkflowAutomation','#DigitalTransformation','#AIConsulting']},
  {group:'Audience', tags:['#SmallBusinessOwner','#OperationsManager','#StartupFounder','#CEOLife']},
  {group:'Tech',     tags:['#AITools','#LangChain','#LLM','#AnthropicClaude','#DataPrivacy']},
  {group:'Growth',   tags:['#BuildInPublic','#TechStartup','#SanDiego','#AIStartup']},
];

const LI_HASHTAGS = [
  {group:'Core',          tags:['#LittleHammerLabs','#AIAgents','#BusinessAutomation','#AgenticAI']},
  {group:'Thought Lead.', tags:['#ArtificialIntelligence','#DigitalTransformation','#FutureOfWork','#TechLeadership']},
  {group:'Audience',      tags:['#CEOLife','#OperationsLeader','#SmallBusiness','#B2B','#Consulting']},
  {group:'Personal Brand',tags:['#BuildInPublic','#FounderLife','#Entrepreneurship','#SanDiego','#AIStartup']},
  {group:'Lead Gen',      tags:['#FreeConsultation','#WorkflowAudit','#AIStrategy','#TechConsulting']},
];

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// STATE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

let viewDate = new Date();
let sbPlatform = 'ig';
let htPlatform = 'ig';
let visIG = true, visLI = true;
let activeIGPillars = new Set(IG_PILLARS.map(p => p.id));
let activeLIPillars = new Set(LI_PILLARS.map(p => p.id));

function loadPosts() {
  try { return JSON.parse(localStorage.getItem('lhl_posts2') || '[]'); } catch { return []; }
}
function savePosts() {
  localStorage.setItem('lhl_posts2', JSON.stringify(POSTS));
}

let POSTS = loadPosts();

// ‚îÄ‚îÄ‚îÄ‚îÄ DRAG ‚îÄ‚îÄ‚îÄ‚îÄ
let dragPayload = null; // { type:'post'|'idea', postId?, ideaIdx?, plat? }

// ‚îÄ‚îÄ‚îÄ‚îÄ EDIT STATE ‚îÄ‚îÄ‚îÄ‚îÄ
let ES = { mode:'add', postId:null, selDate:null, plat:'ig' };
let DS = { postId:null }; // detail state

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// HELPERS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

const DAYS_SHORT = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
const MONTHS = ['January','February','March','April','May','June','July','August','September','October','November','December'];

function today() {
  const n = new Date();
  return fmtDate(n.getFullYear(), n.getMonth(), n.getDate());
}
function fmtDate(y, m, d) {
  return `${y}-${String(m+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
}
function getPillarData(plat, id) {
  const list = plat === 'ig' ? IG_PILLARS : LI_PILLARS;
  return list.find(p => p.id === id) || {label:'?', color:'#888'};
}
function getPostsForDate(dateStr) {
  return POSTS.filter(p => p.date === dateStr);
}
function getPost(id) { return POSTS.find(p => p.id === id); }
function makeId() { return crypto.randomUUID(); }

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SIDEBAR TAB
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function switchSbTab(plat, btn) {
  sbPlatform = plat;
  document.querySelectorAll('.sb-tab').forEach(t => t.classList.remove('active'));
  btn.classList.add('active');

  document.getElementById('pillarSectionLabel').textContent = plat === 'ig' ? 'IG Pillars' : 'LinkedIn Pillars';
  document.getElementById('genLabel').textContent = plat === 'ig' ? 'Generate IG Ideas' : 'Generate LinkedIn Ideas';

  const authorSel = document.getElementById('genAuthor');
  authorSel.style.display = plat === 'li' ? 'block' : 'none';

  const genBtn = document.getElementById('genBtn');
  genBtn.className = plat === 'li' ? 'gbtn li-btn' : 'gbtn';

  populatePillarFilter();
  populateFormatFilter();
  renderPillarList();
  clearIdeas();
}

function populatePillarFilter() {
  const sel = document.getElementById('genPillar');
  const pillars = sbPlatform === 'ig' ? IG_PILLARS : LI_PILLARS;
  sel.innerHTML = '<option value="all">All Pillars</option>' +
    pillars.map(p => `<option value="${p.id}">${p.label}</option>`).join('');
}

function populateFormatFilter() {
  const sel = document.getElementById('genFormat');
  const fmts = sbPlatform === 'ig' ? IG_FORMATS : LI_FORMATS;
  sel.innerHTML = '<option value="all">All Formats</option>' +
    fmts.map(f => `<option value="${f}">${f}</option>`).join('');
}

function clearIdeas() {
  document.getElementById('ideaScroll').innerHTML = '<p class="no-ideas">Hit Generate to get ideas</p>';
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// PILLAR LIST (sidebar)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function renderPillarList() {
  const pillars = sbPlatform === 'ig' ? IG_PILLARS : LI_PILLARS;
  const active = sbPlatform === 'ig' ? activeIGPillars : activeLIPillars;
  const el = document.getElementById('pillarList');
  el.innerHTML = pillars.map(p => {
    const count = POSTS.filter(post => post.plat === sbPlatform && post.pillar === p.id).length;
    return `<button class="pillar-row ${active.has(p.id) ? 'on' : ''}" onclick="togglePillar('${p.id}')">
      <div class="p-dot" style="background:${p.color}"></div>
      ${p.label}
      <span class="p-count">${count}</span>
    </button>`;
  }).join('');
}

function togglePillar(id) {
  const active = sbPlatform === 'ig' ? activeIGPillars : activeLIPillars;
  if (active.has(id)) active.delete(id); else active.add(id);
  renderPillarList();
  renderCalendar();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// IDEA GENERATOR
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function generateIdeas() {
  const pf = document.getElementById('genPillar').value;
  const ff = document.getElementById('genFormat').value;
  const af = document.getElementById('genAuthor').value;
  const bank = sbPlatform === 'ig' ? IG_IDEAS : LI_IDEAS;

  let filtered = bank.filter(idea => {
    const pm = pf === 'all' || idea.pillar === pf;
    const fm = ff === 'all' || idea.format === ff;
    const am = sbPlatform === 'ig' || af === 'all' || idea.author === af.charAt(0).toUpperCase() + af.slice(1) || idea.author === 'LHL';
    return pm && fm && am;
  });

  filtered = filtered.map((idea, i) => ({idea, idx: bank.indexOf(idea), r: Math.random()}))
    .sort((a,b) => a.r - b.r).slice(0, 5);

  const scroll = document.getElementById('ideaScroll');
  if (!filtered.length) { scroll.innerHTML = '<p class="no-ideas">No ideas match those filters</p>'; return; }

  const plat = sbPlatform;
  scroll.innerHTML = filtered.map(({idea, idx}, i) => {
    const pd = getPillarData(plat, idea.pillar);
    const authorBadge = idea.author ? `<span style="font-size:9px;color:var(--text2)">‚Äî ${idea.author}</span>` : '';
    return `<div class="chip ${plat}-chip" style="animation-delay:${i*.07}s"
      draggable="true" ondragstart="onIdeaDrag(event,'${plat}',${idx})">
      <div class="chip-meta" style="color:${pd.color}">${idea.format} ¬∑ ${pd.label} ${authorBadge}</div>
      <div class="chip-title">${idea.title}</div>
      <div class="chip-hook">${idea.hook.slice(0,90)}${idea.hook.length>90?'‚Ä¶':''}</div>
      <button class="chip-add ${plat==='li'?'li-add':''}" onclick="openAddFromIdea('${plat}',${idx})">+ Add to Calendar</button>
    </div>`;
  }).join('');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CALENDAR
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function changeMonth(dir) {
  viewDate = new Date(viewDate.getFullYear(), viewDate.getMonth() + dir, 1);
  renderCalendar();
}

function renderCalendar() {
  document.getElementById('monthLabel').textContent =
    `${MONTHS[viewDate.getMonth()]} ${viewDate.getFullYear()}`;

  // Day headers
  document.getElementById('dayHeaders').innerHTML =
    DAYS_SHORT.map(d => `<div class="dh">${d}</div>`).join('');

  const y = viewDate.getFullYear(), m = viewDate.getMonth();
  const firstDay = new Date(y, m, 1).getDay();
  const daysInMonth = new Date(y, m + 1, 0).getDate();
  const daysInPrev = new Date(y, m, 0).getDate();
  const todayStr = today();

  const cells = [];

  // Prev month padding
  for (let i = firstDay - 1; i >= 0; i--) {
    const d = daysInPrev - i;
    const dateStr = fmtDate(y, m - 1, d);
    cells.push({dateStr, d, current: false});
  }
  // Current month
  for (let d = 1; d <= daysInMonth; d++) {
    cells.push({dateStr: fmtDate(y, m, d), d, current: true});
  }
  // Next month padding
  let next = 1;
  while (cells.length % 7 !== 0) {
    const dateStr = fmtDate(y, m + 1, next);
    cells.push({dateStr, d: next++, current: false});
  }

  const grid = document.getElementById('calGrid');
  grid.innerHTML = cells.map(({dateStr, d, current}) => {
    const isToday = dateStr === todayStr;
    const allPosts = getPostsForDate(dateStr);

    const igPosts = visIG ? allPosts.filter(p => p.plat === 'ig' && activeIGPillars.has(p.pillar)) : [];
    const liPosts = visLI ? allPosts.filter(p => p.plat === 'li' && activeLIPillars.has(p.pillar)) : [];

    const igHtml = igPosts.map(p => renderPill(p)).join('');
    const liHtml = liPosts.map(p => renderPill(p)).join('');

    const hasAny = igPosts.length + liPosts.length > 0;

    return `<div class="cal-cell ${isToday?'today':''} ${current?'':'other-month'}"
      ondragover="onDragOver(event,'${dateStr}')"
      ondrop="onDrop(event,'${dateStr}')"
      ondragleave="onDragLeave(event,'${dateStr}')">
      <div class="cell-head">
        <span class="cell-num">${d}</span>
        <button class="cell-add" onclick="openAdd('ig','${dateStr}',null)" title="Add post">+</button>
      </div>
      ${igHtml}
      ${liHtml}
      ${!hasAny ? `<div class="empty-drop" onclick="openAdd('ig','${dateStr}',null)" ondragover="onDragOver(event,'${dateStr}')" ondrop="onDrop(event,'${dateStr}')">+</div>` : ''}
    </div>`;
  }).join('');
}

function renderPill(post) {
  const pd = getPillarData(post.plat, post.pillar);
  const icon = post.plat === 'ig' ? 'üì∏' : 'üíº';
  const authorStr = post.author && post.plat === 'li' ? `<div class="pill-author">${post.author}</div>` : '';
  return `<div class="post-pill ${post.plat}-pill"
    onclick="openDetail('${post.id}')"
    draggable="true" ondragstart="onPostDrag(event,'${post.id}')">
    <div class="pill-acts">
      <button class="pill-act" onclick="event.stopPropagation();openEditPost('${post.id}')" title="Edit">‚úè</button>
      <button class="pill-act del" onclick="event.stopPropagation();deletePost('${post.id}')" title="Delete">‚úï</button>
    </div>
    <div class="pill-plat">${icon}</div>
    <div class="pill-body">
      <div class="pill-format" style="color:${pd.color}">${post.format}</div>
      <div class="pill-title">${post.title}</div>
      ${authorStr}
    </div>
  </div>`;
}

// ‚îÄ‚îÄ DRAG ‚îÄ‚îÄ
function onPostDrag(e, postId) {
  dragPayload = {type:'post', postId};
  e.dataTransfer.effectAllowed = 'move';
}
function onIdeaDrag(e, plat, idx) {
  dragPayload = {type:'idea', plat, ideaIdx: idx};
  e.dataTransfer.effectAllowed = 'copy';
}
function onDragOver(e, dateStr) {
  e.preventDefault();
  const cell = e.currentTarget.closest?.('.cal-cell') || e.currentTarget;
  cell?.classList.add(dragPayload?.plat === 'li' ? 'drop-li' : 'drop-ig');
}
function onDragLeave(e, dateStr) {
  const cell = e.currentTarget.closest?.('.cal-cell') || e.currentTarget;
  cell?.classList.remove('drop-ig','drop-li');
}
function onDrop(e, dateStr) {
  e.preventDefault();
  const cell = e.currentTarget.closest?.('.cal-cell') || e.currentTarget;
  cell?.classList.remove('drop-ig','drop-li');
  if (!dragPayload) return;

  if (dragPayload.type === 'post') {
    const post = getPost(dragPayload.postId);
    if (post) { post.date = dateStr; savePosts(); renderCalendar(); notify('Post moved!','ok'); }
  } else {
    const bank = dragPayload.plat === 'ig' ? IG_IDEAS : LI_IDEAS;
    const idea = bank[dragPayload.ideaIdx];
    if (idea) {
      POSTS.push({
        id: makeId(), plat: dragPayload.plat, date: dateStr,
        pillar: idea.pillar, format: idea.format, title: idea.title,
        hook: idea.hook, body: idea.body, hashtags: idea.hashtags,
        author: idea.author || '',
      });
      savePosts(); renderCalendar(); renderPillarList();
      notify('Idea added to calendar!','ok');
    }
  }
  dragPayload = null;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// PLATFORM VISIBILITY
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function togglePlatVis(plat) {
  if (plat === 'ig') { visIG = !visIG; document.getElementById('legendIG').classList.toggle('off', !visIG); }
  else { visLI = !visLI; document.getElementById('legendLI').classList.toggle('off', !visLI); }
  renderCalendar();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ADD / EDIT MODAL
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function populateModalPillar(plat) {
  const pillars = plat === 'ig' ? IG_PILLARS : LI_PILLARS;
  document.getElementById('fPillar').innerHTML = pillars.map(p =>
    `<option value="${p.id}">${p.label}</option>`).join('');
}
function populateModalFormat(plat) {
  const fmts = plat === 'ig' ? IG_FORMATS : LI_FORMATS;
  document.getElementById('fFormat').innerHTML = fmts.map(f =>
    `<option value="${f}">${f}</option>`).join('');
}

function onPlatChange() {
  const plat = document.getElementById('fPlat').value;
  ES.plat = plat;
  populateModalPillar(plat);
  populateModalFormat(plat);
  document.getElementById('authorField').style.display = plat === 'li' ? 'block' : 'none';
  document.getElementById('savePrimary').className = plat === 'li' ? 'btn-primary li-btn' : 'btn-primary';
  if (ES.selDate) renderDayPicker(ES.selDate);
}

function openAdd(plat, dateStr, fromIdea) {
  ES = {mode:'add', postId:null, selDate: dateStr, plat};
  document.getElementById('editModalTitle').textContent = 'Add Post';
  document.getElementById('fPlat').value = plat;
  populateModalPillar(plat);
  populateModalFormat(plat);
  document.getElementById('authorField').style.display = plat === 'li' ? 'block' : 'none';
  document.getElementById('savePrimary').className = plat === 'li' ? 'btn-primary li-btn' : 'btn-primary';
  clearForm();
  if (fromIdea) fillFormFromIdea(plat, fromIdea);
  renderDayPicker(dateStr);
  document.getElementById('editOverlay').classList.add('open');
}

function openAddFromIdea(plat, ideaIdx) {
  openAdd(plat, null, {plat, ideaIdx});
}

function fillFormFromIdea(plat, {ideaIdx}) {
  const idea = (plat === 'ig' ? IG_IDEAS : LI_IDEAS)[ideaIdx];
  if (!idea) return;
  document.getElementById('fPillar').value = idea.pillar;
  document.getElementById('fFormat').value = idea.format;
  document.getElementById('fTitle').value = idea.title;
  document.getElementById('fHook').value = idea.hook;
  document.getElementById('fBody').value = idea.body;
  document.getElementById('fTags').value = idea.hashtags;
  if (idea.author) document.getElementById('fAuthor').value = idea.author;
}

function openEditPost(postId) {
  const post = getPost(postId);
  if (!post) return;
  ES = {mode:'edit', postId, selDate: post.date, plat: post.plat};
  document.getElementById('editModalTitle').textContent = 'Edit Post';
  document.getElementById('fPlat').value = post.plat;
  populateModalPillar(post.plat);
  populateModalFormat(post.plat);
  document.getElementById('authorField').style.display = post.plat === 'li' ? 'block' : 'none';
  document.getElementById('savePrimary').className = post.plat === 'li' ? 'btn-primary li-btn' : 'btn-primary';
  document.getElementById('fPillar').value = post.pillar;
  document.getElementById('fFormat').value = post.format;
  document.getElementById('fTitle').value = post.title;
  document.getElementById('fHook').value = post.hook || '';
  document.getElementById('fBody').value = post.body || '';
  document.getElementById('fTags').value = post.hashtags || '';
  if (post.author) document.getElementById('fAuthor').value = post.author;
  renderDayPicker(post.date);
  document.getElementById('editOverlay').classList.add('open');
}

function clearForm() {
  ['fTitle','fHook','fBody','fTags'].forEach(id => document.getElementById(id).value = '');
}

function renderDayPicker(selectedDate) {
  // Show 4 weeks starting from start of current view month
  const y = viewDate.getFullYear(), m = viewDate.getMonth();
  const todayStr = today();
  let html = `<div></div>${DAYS_SHORT.map(d=>`<div class="dp-dh">${d.slice(0,2)}</div>`).join('')}`;

  for (let w = 0; w < 4; w++) {
    const weekStart = new Date(y, m, 1 + w * 7);
    html += `<div class="dp-wk">W${w+1}</div>`;
    for (let d = 0; d < 7; d++) {
      const dt = new Date(weekStart);
      dt.setDate(weekStart.getDate() - weekStart.getDay() + d);
      const ds = fmtDate(dt.getFullYear(), dt.getMonth(), dt.getDate());
      const isToday = ds === todayStr;
      const isSel = ds === selectedDate || ds === ES.selDate;
      const hasPosts = getPostsForDate(ds).length > 0;
      const dayNum = dt.getDate();
      html += `<button class="dp-btn ${isSel?'sel':''} ${isToday&&!isSel?'today-dp':''} ${hasPosts&&!isSel?'has-post':''}"
        onclick="selectDate('${ds}')">${dayNum}</button>`;
    }
  }
  document.getElementById('dpGrid').innerHTML = html;
}

function selectDate(ds) {
  ES.selDate = ds;
  renderDayPicker(ds);
}

function savePost() {
  const title = document.getElementById('fTitle').value.trim();
  if (!title) { notify('Please add a title','err'); return; }
  if (!ES.selDate) { notify('Please select a date','err'); return; }
  const plat = document.getElementById('fPlat').value;

  const post = {
    id: ES.postId || makeId(),
    plat,
    date: ES.selDate,
    pillar: document.getElementById('fPillar').value,
    format: document.getElementById('fFormat').value,
    title,
    hook: document.getElementById('fHook').value.trim(),
    body: document.getElementById('fBody').value.trim(),
    hashtags: document.getElementById('fTags').value.trim(),
    author: plat === 'li' ? document.getElementById('fAuthor').value : '',
  };

  if (ES.mode === 'edit') {
    const idx = POSTS.findIndex(p => p.id === post.id);
    if (idx >= 0) POSTS[idx] = post; else POSTS.push(post);
  } else {
    POSTS.push(post);
  }

  savePosts();
  closeOvl('editOverlay');
  renderCalendar();
  renderPillarList();
  notify(ES.mode === 'edit' ? 'Post updated!':'Post added!','ok');
}

function deletePost(postId) {
  POSTS = POSTS.filter(p => p.id !== postId);
  savePosts();
  renderCalendar();
  renderPillarList();
  notify('Post deleted','ok');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DETAIL MODAL
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function openDetail(postId) {
  const post = getPost(postId);
  if (!post) return;
  DS.postId = postId;
  const pd = getPillarData(post.plat, post.pillar);
  const platName = post.plat === 'ig' ? 'üì∏ Instagram' : 'üíº LinkedIn';

  document.getElementById('detailTitle').textContent = post.title;
  document.getElementById('copyBtn').className = post.plat === 'li' ? 'btn-primary li-btn' : 'btn-primary';
  document.getElementById('detailBody').innerHTML = `
    <p style="font-size:11px;color:var(--text2);margin-bottom:2px">${platName} ¬∑ <span style="color:${pd.color}">${pd.label}</span> ¬∑ ${post.format}${post.author?' ¬∑ '+post.author:''}</p>
    <p style="font-size:11px;color:var(--muted);margin-bottom:8px">üìÖ ${post.date}</p>
    ${post.hook?`<div class="det-label">Hook</div><div class="det-block">${post.hook.replace(/\n/g,'<br>')}</div>`:''}
    ${post.body?`<div class="det-label">Content Notes</div><p style="font-size:12px;line-height:1.7;color:var(--text2);margin-top:4px">${post.body.replace(/\n/g,'<br>')}</p>`:''}
    ${post.hashtags?`<div class="det-label">Hashtags</div><p style="font-family:'Space Mono',monospace;font-size:10px;color:var(--muted);margin-top:4px;line-height:2">${post.hashtags}</p>`:''}
  `;
  document.getElementById('detailOverlay').classList.add('open');
}

function editFromDetail() {
  closeOvl('detailOverlay');
  openEditPost(DS.postId);
}

function copyCaption() {
  const post = getPost(DS.postId);
  if (!post) return;
  const t = [post.hook, '', post.body, '', post.hashtags, '#LittleHammerLabs']
    .filter(Boolean).join('\n');
  navigator.clipboard.writeText(t).then(() => notify('Caption copied!','ok')).catch(()=>{});
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// HASHTAG BANK
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function switchHtTab(plat, btn) {
  htPlatform = plat;
  document.querySelectorAll('.ht-tab').forEach(t => { t.classList.remove('active'); });
  btn.classList.add('active');
  renderHashtags();
}

function renderHashtags() {
  const bank = htPlatform === 'ig' ? IG_HASHTAGS : LI_HASHTAGS;
  document.getElementById('htGroups').innerHTML = bank.map(g => `
    <div>
      <h4>${g.group}</h4>
      <div class="ht-tags">${g.tags.map(t=>`<span class="htag" onclick="copyHtag(this,'${t}')">${t}</span>`).join('')}</div>
    </div>
  `).join('');
}

function copyHtag(el, tag) {
  navigator.clipboard.writeText(tag).catch(()=>{});
  const o = el.textContent; el.textContent='‚úì'; el.classList.add('copied');
  setTimeout(()=>{ el.textContent=o; el.classList.remove('copied'); }, 1200);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// EXPORT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function exportCSV() {
  const rows = [['Date','Platform','Author','Pillar','Format','Title','Hook','Notes','Hashtags']];
  const sorted = [...POSTS].sort((a,b) => a.date.localeCompare(b.date));
  sorted.forEach(p => {
    rows.push([p.date, p.plat.toUpperCase(), p.author||'', getPillarData(p.plat,p.pillar).label, p.format, p.title, p.hook, p.body, p.hashtags]);
  });
  const csv = rows.map(r=>r.map(c=>`"${(c||'').replace(/"/g,'""')}"`).join(',')).join('\n');
  const blob = new Blob([csv],{type:'text/csv'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href=url; a.download='lhl-content.csv'; a.click();
  URL.revokeObjectURL(url);
  notify('CSV exported!','ok');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// UTILS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function closeOvl(id, e) {
  if (e && e.target !== document.getElementById(id)) return;
  document.getElementById(id).classList.remove('open');
}

let notifyTimer;
function notify(msg, type='ok') {
  const el = document.getElementById('notify');
  el.textContent = msg; el.className = `notify ${type} show`;
  clearTimeout(notifyTimer);
  notifyTimer = setTimeout(()=>el.classList.remove('show'), 2400);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// INIT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

populatePillarFilter();
populateFormatFilter();
renderPillarList();
renderCalendar();
renderHashtags();
populateModalPillar('ig');
populateModalFormat('ig');
</script>
</body>
</html>
