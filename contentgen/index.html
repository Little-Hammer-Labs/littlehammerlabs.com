<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LHL Content Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Space+Mono:ital,wght@0,400;0,700;1,400&family=DM+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #0a0a0f;
  --surface: #111118;
  --surface2: #1a1a24;
  --surface3: #22222f;
  --border: #2a2a3a;
  --border2: #3a3a4a;
  --accent: #ff5c35;
  --accent-dim: rgba(255,92,53,0.12);
  --text: #e8e8f0;
  --text2: #a0a0b8;
  --muted: #5a5a72;
  --success: #4ade80;
  --danger: #f87171;

  --c-edu: #4A9EFF;
  --c-social: #4CAF50;
  --c-bts: #FF9800;
  --c-pain: #ff5c35;
  --c-product: #AB47BC;
}

* { margin:0; padding:0; box-sizing:border-box; }

body {
  font-family: 'DM Sans', sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
}

body::before {
  content:'';
  position:fixed; inset:0;
  background-image:
    linear-gradient(rgba(255,92,53,0.025) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255,92,53,0.025) 1px, transparent 1px);
  background-size: 48px 48px;
  pointer-events:none; z-index:0;
}

/* â”€â”€ LAYOUT â”€â”€ */
.app { display:flex; min-height:100vh; position:relative; z-index:1; }

.sidebar {
  width: 280px;
  min-width: 280px;
  background: var(--surface);
  border-right: 1px solid var(--border);
  display: flex;
  flex-direction: column;
  position: sticky;
  top: 0;
  height: 100vh;
  overflow-y: auto;
}

.main { flex:1; overflow-x:hidden; }

/* â”€â”€ SIDEBAR â”€â”€ */
.sidebar-header {
  padding: 24px 20px 16px;
  border-bottom: 1px solid var(--border);
}

.sidebar-header h1 {
  font-family: 'Space Mono', monospace;
  font-size: 15px;
  letter-spacing: -0.5px;
}
.sidebar-header h1 span { color: var(--accent); }
.sidebar-header p { font-size: 11px; color: var(--muted); margin-top: 4px; text-transform: uppercase; letter-spacing: 0.5px; }

.sidebar-section { padding: 16px 20px; border-bottom: 1px solid var(--border); }
.sidebar-section-title {
  font-family: 'Space Mono', monospace;
  font-size: 10px;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 1.5px;
  margin-bottom: 12px;
}

.pillar-filter {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.pillar-btn {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 7px 10px;
  border-radius: 7px;
  border: 1px solid transparent;
  cursor: pointer;
  background: none;
  color: var(--text2);
  font-size: 12px;
  font-family: 'DM Sans', sans-serif;
  font-weight: 500;
  transition: all 0.15s;
  text-align: left;
  width: 100%;
}
.pillar-btn:hover { background: var(--surface2); color: var(--text); }
.pillar-btn.active { background: var(--surface2); border-color: var(--border2); color: var(--text); }
.pillar-dot { width:8px; height:8px; border-radius:50%; flex-shrink:0; }
.pillar-count { margin-left:auto; font-family:'Space Mono',monospace; font-size:10px; color:var(--muted); }

/* â”€â”€ GEN CONTROLS in sidebar â”€â”€ */
.gen-controls { display:flex; flex-direction:column; gap:8px; }
.gen-select {
  background: var(--surface2);
  border: 1px solid var(--border);
  color: var(--text);
  padding: 8px 10px;
  border-radius: 7px;
  font-family: 'DM Sans', sans-serif;
  font-size: 12px;
  cursor: pointer;
  outline: none;
  transition: border-color 0.2s;
  width: 100%;
}
.gen-select:focus { border-color: var(--accent); }

.gen-btn {
  background: var(--accent);
  color: white;
  border: none;
  padding: 9px 14px;
  border-radius: 7px;
  font-family: 'Space Mono', monospace;
  font-size: 11px;
  cursor: pointer;
  transition: all 0.2s;
  width: 100%;
}
.gen-btn:hover { background: #ff7055; box-shadow: 0 4px 16px rgba(255,92,53,0.3); }

/* â”€â”€ IDEA CARDS in sidebar â”€â”€ */
.idea-list { display:flex; flex-direction:column; gap:8px; padding: 12px 16px 20px; }

.idea-chip {
  background: var(--surface2);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 10px 12px;
  cursor: pointer;
  transition: all 0.15s;
  animation: fadeUp 0.3s ease both;
}
.idea-chip:hover { border-color: var(--accent); box-shadow: 0 2px 12px rgba(255,92,53,0.12); }
.idea-chip.dragging { opacity: 0.5; }

.idea-chip-type {
  font-family: 'Space Mono', monospace;
  font-size: 9px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 4px;
}
.idea-chip-title { font-size: 11.5px; font-weight: 600; line-height: 1.35; color: var(--text); }
.idea-chip-hook { font-size: 10.5px; color: var(--text2); line-height: 1.4; margin-top: 4px; }

.add-to-cal-btn {
  margin-top: 8px;
  background: none;
  border: 1px solid var(--border);
  color: var(--text2);
  font-size: 10px;
  font-family: 'Space Mono', monospace;
  padding: 4px 8px;
  border-radius: 5px;
  cursor: pointer;
  transition: all 0.15s;
  width: 100%;
}
.add-to-cal-btn:hover { border-color: var(--accent); color: var(--accent); }

/* â”€â”€ MAIN CONTENT â”€â”€ */
.main-header {
  padding: 28px 32px 0;
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: 12px;
}

.week-nav {
  display: flex;
  align-items: center;
  gap: 8px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 8px 14px;
}
.week-nav button {
  background: none; border: none;
  color: var(--muted); cursor: pointer;
  font-size: 16px; font-family: 'Space Mono', monospace;
  transition: color 0.15s;
}
.week-nav button:hover { color: var(--accent); }
.week-nav-label {
  font-family: 'Space Mono', monospace;
  font-size: 12px;
  min-width: 80px;
  text-align: center;
}

.main-actions { display:flex; gap:8px; }

.btn-sm {
  background: var(--surface);
  border: 1px solid var(--border);
  color: var(--text2);
  padding: 7px 14px;
  border-radius: 7px;
  font-size: 12px;
  font-family: 'DM Sans', sans-serif;
  cursor: pointer;
  transition: all 0.15s;
}
.btn-sm:hover { border-color: var(--accent); color: var(--accent); }
.btn-sm.danger:hover { border-color: var(--danger); color: var(--danger); }

/* â”€â”€ CALENDAR â”€â”€ */
.calendar-wrap { padding: 20px 32px 40px; }

.day-labels {
  display: grid;
  grid-template-columns: repeat(7,1fr);
  gap: 8px;
  margin-bottom: 6px;
}
.day-label {
  text-align: center;
  font-family: 'Space Mono', monospace;
  font-size: 10px;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 1px;
  padding: 4px;
}

.cal-grid {
  display: grid;
  grid-template-columns: repeat(7,1fr);
  gap: 8px;
}

.cal-cell {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 12px;
  min-height: 140px;
  padding: 10px 8px;
  display: flex;
  flex-direction: column;
  gap: 6px;
  transition: all 0.15s;
  position: relative;
}

.cal-cell.drop-target {
  border-color: var(--accent);
  background: var(--accent-dim);
}

.cal-cell.rest-cell {
  background: transparent;
  border-color: transparent;
  opacity: 0.3;
}

.cell-day {
  font-family: 'Space Mono', monospace;
  font-size: 11px;
  color: var(--muted);
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.cell-add-btn {
  background: none; border: none;
  color: var(--muted);
  cursor: pointer;
  font-size: 14px;
  line-height: 1;
  transition: color 0.15s;
  opacity: 0;
}
.cal-cell:hover .cell-add-btn { opacity: 1; }
.cell-add-btn:hover { color: var(--accent); }

.post-pill {
  border-radius: 7px;
  padding: 7px 8px;
  border: 1px solid transparent;
  cursor: pointer;
  transition: all 0.15s;
  position: relative;
  group: true;
}
.post-pill:hover { filter: brightness(1.1); }

.post-pill-format {
  font-family: 'Space Mono', monospace;
  font-size: 8.5px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  opacity: 0.75;
  margin-bottom: 2px;
}
.post-pill-title { font-size: 10px; font-weight: 600; line-height: 1.35; }

.pill-actions {
  display: none;
  position: absolute;
  top: 3px; right: 3px;
  gap: 3px;
}
.post-pill:hover .pill-actions { display: flex; }

.pill-action-btn {
  background: rgba(0,0,0,0.5);
  border: none;
  color: white;
  width: 18px; height: 18px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 9px;
  display: flex; align-items:center; justify-content:center;
  transition: background 0.15s;
}
.pill-action-btn:hover { background: var(--accent); }
.pill-action-btn.del:hover { background: var(--danger); }

.empty-slot {
  flex: 1;
  border: 1px dashed var(--border);
  border-radius: 7px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--muted);
  font-size: 18px;
  cursor: pointer;
  transition: all 0.15s;
  min-height: 50px;
}
.empty-slot:hover { border-color: var(--accent); color: var(--accent); background: var(--accent-dim); }

/* â”€â”€ HASHTAG BANK â”€â”€ */
.hashtag-section {
  margin: 0 32px 40px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 22px 24px;
}
.section-title {
  font-family: 'Space Mono', monospace;
  font-size: 11px;
  color: var(--accent);
  text-transform: uppercase;
  letter-spacing: 2px;
  margin-bottom: 16px;
  display: flex; align-items:center; gap:10px;
}
.section-title::after { content:''; flex:1; height:1px; background:var(--border); }

.hashtag-groups { display:flex; flex-wrap:wrap; gap:16px; }
.hashtag-group h4 { font-family:'Space Mono',monospace; font-size:10px; color:var(--muted); text-transform:uppercase; letter-spacing:1px; margin-bottom:8px; }
.hashtag-tags { display:flex; flex-wrap:wrap; gap:5px; }
.htag {
  font-size:11px; color:var(--text2);
  background:var(--surface2); border:1px solid var(--border);
  border-radius:4px; padding:3px 8px;
  font-family:'Space Mono',monospace;
  cursor:pointer; transition:all 0.15s; user-select:none;
}
.htag:hover { border-color:var(--accent); color:var(--accent); }
.htag.copied { border-color:var(--success); color:var(--success); }

/* â”€â”€ MODALS â”€â”€ */
.overlay {
  position:fixed; inset:0;
  background:rgba(0,0,0,0.75);
  backdrop-filter:blur(8px);
  z-index:200;
  display:none; align-items:center; justify-content:center;
  padding:20px;
}
.overlay.open { display:flex; animation:fadeIn 0.15s ease; }

.modal {
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:16px;
  padding:28px;
  width:100%; max-width:520px;
  position:relative;
  max-height:90vh;
  overflow-y:auto;
}

.modal-close {
  position:absolute; top:14px; right:14px;
  background:none; border:none; color:var(--muted);
  font-size:18px; cursor:pointer; transition:color 0.15s;
}
.modal-close:hover { color:var(--accent); }

.modal h2 {
  font-family:'Space Mono',monospace;
  font-size:15px; margin-bottom:20px;
  line-height:1.4; padding-right:30px;
}

.form-field { margin-bottom:14px; }
.form-field label {
  display:block;
  font-size:10px; color:var(--muted);
  text-transform:uppercase; letter-spacing:0.5px;
  margin-bottom:5px; font-family:'Space Mono',monospace;
}
.form-field input,
.form-field textarea,
.form-field select {
  width:100%;
  background:var(--surface2);
  border:1px solid var(--border);
  color:var(--text);
  padding:9px 12px;
  border-radius:8px;
  font-family:'DM Sans',sans-serif;
  font-size:13px;
  outline:none;
  transition:border-color 0.2s;
  resize:vertical;
}
.form-field input:focus,
.form-field textarea:focus,
.form-field select:focus { border-color:var(--accent); }
.form-field textarea { min-height:80px; }

.modal-actions { display:flex; gap:10px; margin-top:20px; }
.btn-primary {
  flex:1; background:var(--accent); color:white;
  border:none; padding:10px;
  border-radius:8px; font-family:'Space Mono',monospace;
  font-size:11px; cursor:pointer; transition:all 0.15s;
}
.btn-primary:hover { background:#ff7055; }
.btn-ghost {
  background:none; border:1px solid var(--border);
  color:var(--text2); padding:10px 16px;
  border-radius:8px; font-family:'Space Mono',monospace;
  font-size:11px; cursor:pointer; transition:all 0.15s;
}
.btn-ghost:hover { border-color:var(--border2); color:var(--text); }

/* Detail modal */
.detail-block {
  background:var(--surface2); border:1px solid var(--border);
  border-radius:8px; padding:12px;
  font-size:12.5px; line-height:1.7;
  color:var(--text); margin-bottom:4px;
  font-style:italic;
}
.detail-label {
  font-family:'Space Mono',monospace;
  font-size:10px; color:var(--muted);
  text-transform:uppercase; letter-spacing:0.5px;
  margin-bottom:4px; margin-top:12px;
}

/* â”€â”€ PICK DAY MODAL â”€â”€ */
.day-picker-grid {
  display:grid; grid-template-columns:repeat(7,1fr);
  gap:6px; margin-bottom:16px;
}
.day-picker-label {
  text-align:center; font-family:'Space Mono',monospace;
  font-size:9px; color:var(--muted);
  text-transform:uppercase; letter-spacing:0.5px;
  padding:3px 0;
}
.day-picker-btn {
  background:var(--surface2); border:1px solid var(--border);
  color:var(--text); padding:10px 4px;
  border-radius:7px; font-family:'Space Mono',monospace;
  font-size:10px; cursor:pointer; transition:all 0.15s;
  text-align:center;
}
.day-picker-btn:hover:not(:disabled) { border-color:var(--accent); color:var(--accent); }
.day-picker-btn:disabled { opacity:0.2; cursor:not-allowed; }
.day-picker-btn.occupied { border-color:var(--border2); color:var(--text2); }
.week-row-label {
  font-family:'Space Mono',monospace; font-size:10px;
  color:var(--muted); align-self:center;
  padding-right:6px; white-space:nowrap;
}

/* Notify */
.notify {
  position:fixed; bottom:24px; right:24px;
  background:var(--surface2); border:1px solid var(--border);
  border-radius:10px; padding:12px 18px;
  font-size:13px; z-index:300;
  transform:translateY(80px); opacity:0;
  transition:all 0.3s ease;
  pointer-events:none;
}
.notify.show { transform:translateY(0); opacity:1; }
.notify.success { border-color:var(--success); color:var(--success); }
.notify.error { border-color:var(--danger); color:var(--danger); }

@keyframes fadeIn { from{opacity:0;transform:translateY(6px)} to{opacity:1;transform:translateY(0)} }
@keyframes fadeUp { from{opacity:0;transform:translateY(10px)} to{opacity:1;transform:translateY(0)} }

::-webkit-scrollbar { width:4px; }
::-webkit-scrollbar-track { background:var(--bg); }
::-webkit-scrollbar-thumb { background:var(--border); border-radius:2px; }
</style>
</head>
<body>

<div class="app">

  <!-- â”€â”€ SIDEBAR â”€â”€ -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <h1>Little<span>Hammer</span>Labs</h1>
      <p>Content Dashboard</p>
    </div>

    <!-- Pillar filters -->
    <div class="sidebar-section">
      <div class="sidebar-section-title">Pillars</div>
      <div class="pillar-filter" id="pillarFilters"></div>
    </div>

    <!-- Idea generator -->
    <div class="sidebar-section">
      <div class="sidebar-section-title">Idea Generator</div>
      <div class="gen-controls">
        <select class="gen-select" id="genPillar">
          <option value="all">All Pillars</option>
          <option value="edu">Education</option>
          <option value="social">Social Proof</option>
          <option value="bts">Behind the Scenes</option>
          <option value="pain">Pain Points</option>
          <option value="product">Product/Feature</option>
        </select>
        <select class="gen-select" id="genFormat">
          <option value="all">All Formats</option>
          <option value="Reel">Reel</option>
          <option value="Carousel">Carousel</option>
          <option value="Static">Static Post</option>
          <option value="Story">Story</option>
        </select>
        <button class="gen-btn" onclick="generateIdeas()">âš¡ Generate Ideas</button>
      </div>
    </div>

    <div class="idea-list" id="ideaList">
      <p style="font-size:11px;color:var(--muted);text-align:center;padding:8px 0">Hit Generate to get ideas â†’</p>
    </div>
  </aside>

  <!-- â”€â”€ MAIN â”€â”€ -->
  <main class="main">
    <div class="main-header">
      <div class="week-nav">
        <button onclick="changeWeek(-1)">â†</button>
        <span class="week-nav-label" id="weekLabel">Week 1</span>
        <button onclick="changeWeek(1)">â†’</button>
      </div>
      <div class="main-actions">
        <button class="btn-sm" onclick="openAddModal(null, null)">+ Add Post</button>
        <button class="btn-sm" onclick="exportCSV()">Export CSV</button>
        <button class="btn-sm danger" onclick="confirmReset()">Reset Week</button>
      </div>
    </div>

    <div class="calendar-wrap">
      <div class="day-labels">
        <div class="day-label">Mon</div>
        <div class="day-label">Tue</div>
        <div class="day-label">Wed</div>
        <div class="day-label">Thu</div>
        <div class="day-label">Fri</div>
        <div class="day-label">Sat</div>
        <div class="day-label">Sun</div>
      </div>
      <div class="cal-grid" id="calGrid"></div>
    </div>

    <div class="hashtag-section">
      <div class="section-title">Hashtag Bank</div>
      <div class="hashtag-groups" id="hashtagGroups"></div>
    </div>
  </main>
</div>

<!-- â”€â”€ ADD/EDIT MODAL â”€â”€ -->
<div class="overlay" id="editOverlay" onclick="closeOverlay('editOverlay',event)">
  <div class="modal">
    <button class="modal-close" onclick="closeOverlay('editOverlay')">âœ•</button>
    <h2 id="editTitle">Add Post</h2>
    <div class="form-field">
      <label>Title / Idea</label>
      <input type="text" id="fTitle" placeholder="e.g. 'What even IS an AI Agent?' explainer">
    </div>
    <div class="form-field">
      <label>Pillar</label>
      <select id="fPillar">
        <option value="edu">Education</option>
        <option value="social">Social Proof</option>
        <option value="bts">Behind the Scenes</option>
        <option value="pain">Pain Points</option>
        <option value="product">Product / Feature</option>
      </select>
    </div>
    <div class="form-field">
      <label>Format</label>
      <select id="fFormat">
        <option value="Reel">Reel</option>
        <option value="Carousel">Carousel</option>
        <option value="Static">Static Post</option>
        <option value="Story">Story</option>
      </select>
    </div>
    <div class="form-field">
      <label>Hook / Opening Line</label>
      <textarea id="fHook" placeholder="The first line of your caption..."></textarea>
    </div>
    <div class="form-field">
      <label>Content Notes</label>
      <textarea id="fBody" placeholder="Slide breakdown, talking points, visual direction..."></textarea>
    </div>
    <div class="form-field">
      <label>Hashtags (comma separated)</label>
      <input type="text" id="fTags" placeholder="#AIAgents, #BusinessAutomation">
    </div>
    <div id="dayPickerWrap" style="display:none">
      <div class="form-field">
        <label>Choose Day to Schedule</label>
      </div>
      <div style="display:grid; grid-template-columns: auto repeat(7,1fr); gap:6px; margin-bottom:12px;" id="dayPickerGrid"></div>
    </div>
    <div class="modal-actions">
      <button class="btn-ghost" onclick="closeOverlay('editOverlay')">Cancel</button>
      <button class="btn-primary" onclick="savePost()">Save Post</button>
    </div>
  </div>
</div>

<!-- â”€â”€ DETAIL MODAL â”€â”€ -->
<div class="overlay" id="detailOverlay" onclick="closeOverlay('detailOverlay',event)">
  <div class="modal">
    <button class="modal-close" onclick="closeOverlay('detailOverlay')">âœ•</button>
    <h2 id="detailTitle"></h2>
    <div id="detailBody"></div>
    <div class="modal-actions">
      <button class="btn-ghost" onclick="editFromDetail()">âœ Edit</button>
      <button class="btn-primary" onclick="copyCaption()">Copy Caption</button>
    </div>
  </div>
</div>

<div class="notify" id="notify"></div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DATA
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const PILLARS = [
  { id:'edu',     label:'Education',        color:'#4A9EFF' },
  { id:'social',  label:'Social Proof',     color:'#4CAF50' },
  { id:'bts',     label:'Behind the Scenes',color:'#FF9800' },
  { id:'pain',    label:'Pain Points',      color:'#ff5c35' },
  { id:'product', label:'Product/Feature',  color:'#AB47BC' },
];

const IDEA_BANK = [
  { pillar:'edu',     format:'Carousel', title:'"What even IS an AI Agent?" explainer',       hook:'Everyone says AI but most people mean chatbot. Here\'s the actual difference ğŸ‘‡',                                 body:'Slide 1: AI Chatbot vs AI Agent. Slide 2: Chatbot answers â€” Agent acts. Slide 3: Real example â€” a client email at 6pm triggers a full response workflow. Slide 4: The 3 components of an agent. Slide 5: CTA.', hashtags:'#AIAgents,#BusinessAutomation,#AIForBusiness' },
  { pillar:'edu',     format:'Reel',     title:'60-sec: How we built an AI that reads your CRM',hook:'We built an AI that reads your CRM, emails, and files â€” and acts on all three.',                               body:'Screen recording walkthrough. Email arrives â†’ agent pulls CRM data â†’ generates response â†’ logs it. Under 60 seconds. Show the magic, keep it fast.',                                                            hashtags:'#AIDemo,#CRMAutomation,#SmallBusiness' },
  { pillar:'edu',     format:'Carousel', title:'5 signs your team is ready for an AI agent',   hook:'Not every business needs an AI agent right now. But here are 5 signs yours does.',                            body:'1. Answer same questions 20x/week. 2. Leads go cold from manual follow-up. 3. Data lives in 3 tools. 4. After-hours requests go unanswered. 5. Team drowning in admin.',                                      hashtags:'#BusinessEfficiency,#AIStrategy,#OperationsManagement' },
  { pillar:'edu',     format:'Static',   title:'"LLM vs AI Agent" comparison graphic',         hook:'A language model talks. An agent does.',                                                                        body:'Clean split graphic. Left = LLM (generates text, one-shot, no actions). Right = AI Agent (takes actions, uses tools, multi-step, autonomous). Bold and branded.',                                              hashtags:'#LLM,#AIAgents,#MachineLearning' },
  { pillar:'edu',     format:'Reel',     title:'Private LLM deployment explained in 60 seconds',hook:'Your data shouldn\'t live on someone else\'s servers. Here\'s what private LLM deployment looks like.',       body:'Diagram: client data â†’ local/private model â†’ output. Contrast with public APIs. Zero data exposure. End with: "We build these in 2-4 weeks."',                                                               hashtags:'#DataPrivacy,#PrivateAI,#AICompliance' },
  { pillar:'social',  format:'Carousel', title:'Diehl Group Architects case study',             hook:'An architecture firm was spending hours transcribing site visits. We fixed that.',                             body:'Slide 1: The problem â€” hours of manual notes. Slide 2: What we built â€” AI transcription â†’ structured docs. Slide 3: Result â€” hours saved, zero manual work. Slide 4: Quote. Slide 5: CTA.',                   hashtags:'#ClientWin,#AIForArchitects,#BusinessAutomation' },
  { pillar:'social',  format:'Static',   title:'"Before / After" workflow visual',              hook:'Before: 4-day response. After: Under 1 hour. Same team. Just smarter tools.',                                 body:'Visual split: manual process (email â†’ sits â†’ Monday â†’ manual research â†’ Tuesday) vs agent process (email â†’ 30 sec â†’ auto-research â†’ 1hr response). Clean, shareable.',                                         hashtags:'#AIResults,#WorkflowAutomation,#Productivity' },
  { pillar:'social',  format:'Reel',     title:'Founding Partner Program spotlight',            hook:'We\'re only working with a handful of founding partners. Here\'s what that looks like.',                       body:'Ryan and Max on camera. What the founding partner program includes, why it\'s limited, what businesses get. Authentic, direct to camera. No script.',                                                           hashtags:'#FoundingPartner,#StartupLife,#AIStartup' },
  { pillar:'social',  format:'Carousel', title:'"We almost said no to this client" story',      hook:'We almost turned this client down. Here\'s what changed our minds â€” and what we built.',                      body:'Vague problem â†’ workflow audit â†’ real bottleneck discovered â†’ custom agent built â†’ outcome. Storytelling format, one beat per slide.',                                                                            hashtags:'#ClientStory,#AIConsulting,#SmallBusinessOwner' },
  { pillar:'bts',     format:'Reel',     title:'Ryan & Max: why we started LHL',                hook:'We kept seeing the same problem. Businesses drowning in repetitive work AI could handle.',                     body:'Casual talking head. Ryan and Max. San Diego backdrop. Origin story, honest and conversational. Show the whiteboard, early prototypes, the "a-ha" moment.',                                                    hashtags:'#Founders,#StartupStory,#SanDiego' },
  { pillar:'bts',     format:'Static',   title:'Our tech stack visual',                         hook:'What\'s powering our agents? Here\'s our stack.',                                                              body:'Logo lockup: Claude (Anthropic) â†’ LangChain â†’ Python/Node â†’ Private cloud â†’ Client tools. Clean, branded graphic. "We don\'t do off-the-shelf."',                                                             hashtags:'#TechStack,#LangChain,#AnthropicClaude' },
  { pillar:'bts',     format:'Reel',     title:'A day in the life building an AI agent',        hook:'What does it actually look like to build a custom AI agent from brief to deployment?',                         body:'Time-lapse/screen share. Discovery call notes â†’ system design â†’ testing â†’ client review â†’ deployment. Fast cuts, engaging VO.',                                                                                hashtags:'#BuildInPublic,#AIEngineering,#DayInTheLife' },
  { pillar:'bts',     format:'Story',    title:'Poll: What\'s your biggest time drain?',        hook:'We\'re always curious â€” what eats your team\'s time most?',                                                    body:'Story poll: A) Email & follow-ups  B) Data entry & reporting  C) Client requests  D) Scheduling & coordination. DM respondents to start a conversation.',                                                     hashtags:'' },
  { pillar:'pain',    format:'Static',   title:'"Your team answers the same email 40x/week"',   hook:'Your smartest people are copy-pasting the same answer. Over and over. That\'s the real cost of not automating.',body:'Bold typographic post. Dark background, white text. One punchy stat. No fluff. CTA in caption.',                                                                                                       hashtags:'#BusinessProblem,#Automation,#OperationsLeader' },
  { pillar:'pain',    format:'Carousel', title:'"The real cost of manual processes"',           hook:'You\'re probably not tracking this. But the math is brutal.',                                                  body:'Slide 1: 40% of knowledge worker time = repetitive tasks. Slide 2: $60k salary â†’ $24k/yr automatable. Slide 3: 5 employees = $120k wasted. Slide 4: An AI agent costs a fraction. Slide 5: CTA.',             hashtags:'#ROI,#BusinessCosts,#AIInvestment' },
  { pillar:'pain',    format:'Reel',     title:'"Why your team hates Monday mornings"',         hook:'It\'s not the meetings. It\'s the inbox full of stuff that piled up Friday at 5pm.',                           body:'Relatable hook. Quick cuts showing inbox dread. Pivot: "What if a system handled it while you were at dinner Friday?" Show the agent workflow. CTA.',                                                           hashtags:'#WorkLifeBalance,#SmallBusinessProblems,#AIHelp' },
  { pillar:'pain',    format:'Carousel', title:'"Why your AI chatbot isn\'t working"',          hook:'You tried a chatbot. It answered FAQs. Your team is still drowning. Here\'s why.',                             body:'5 slides on the difference between chatbots and agentic systems. End with: "You don\'t need a chatbot. You need an agent."',                                                                                    hashtags:'#Chatbot,#AIAgent,#DigitalTransformation' },
  { pillar:'product', format:'Reel',     title:'Live demo: Agent handles a request end-to-end', hook:'Watch this AI agent handle a full client request â€” no human touch required.',                                   body:'Screen recording with VO. Email arrives â†’ agent classifies â†’ pulls from CRM â†’ drafts response â†’ logs â†’ sends. Real workflow, 90 seconds.',                                                                       hashtags:'#AIDemo,#LiveDemo,#AutomationTool' },
  { pillar:'product', format:'Carousel', title:'"3 agents we\'ve built this quarter"',          hook:'Every agent we build is different. Here are 3 from this quarter.',                                             body:'Agent 1: Architecture transcription (Diehl). Agent 2: Lead follow-up automation. Agent 3: Document processing. Each slide: client type â†’ problem â†’ what we built â†’ result.',                                  hashtags:'#CustomAI,#AIBuilds,#AgentShowcase' },
  { pillar:'product', format:'Static',   title:'Pilot program explainer graphic',               hook:'2â€“4 weeks. One workflow. Real results before you commit.',                                                      body:'Clean infographic. Step 1: Discovery (free) â†’ Step 2: Pilot (2-4 weeks) â†’ Step 3: Deploy â†’ Step 4: Optimize. LHL branded. Simple, confident, zero fluff.',                                                   hashtags:'#LowRiskAI,#AIForSMB,#TechConsulting' },
];

const HASHTAG_BANK = [
  { group:'Core Brand',  tags:['#LittleHammerLabs','#AIAgents','#CustomAI','#PrivateAI','#AgenticAI'] },
  { group:'Industry',    tags:['#BusinessAutomation','#WorkflowAutomation','#DigitalTransformation','#AIConsulting','#EnterpriseAI'] },
  { group:'Audience',    tags:['#SmallBusinessOwner','#OperationsManager','#StartupFounder','#CEOLife','#BusinessLeader'] },
  { group:'Tech',        tags:['#AITools','#LangChain','#LLM','#AnthropicClaude','#DataPrivacy','#MLOps'] },
  { group:'Community',   tags:['#BuildInPublic','#TechStartup','#SanDiego','#AIStartup','#TechFounder'] },
];

const DAYS = ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'];
const REST_DAYS = [5, 6]; // Sat, Sun = index 5, 6

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

let currentWeek = 0;
let activePillars = new Set(PILLARS.map(p => p.id));
let generatedIdeas = [];

// Calendar data: { [weekIdx]: { [dayIdx]: [post, ...] } }
function loadCalendar() {
  try { return JSON.parse(localStorage.getItem('lhl_calendar') || '{}'); } catch { return {}; }
}
function saveCalendar(cal) {
  localStorage.setItem('lhl_calendar', JSON.stringify(cal));
}

let calendar = loadCalendar();

// Seed default posts if week 0 is empty
function seedDefaults() {
  if (calendar['0']) return;
  const defaults = [
    { day:0, post: makePost('pain','Static','"Your Team Answers the Same Email 40x/Week"','Your smartest people are copy-pasting the same answer. Over and over. That\'s the real cost of not automating.','Bold typographic post. Dark background, white text. One stat. No fluff. CTA in caption.','#BusinessProblem,#Automation,#OperationsLeader') },
    { day:1, post: makePost('edu','Carousel','"What Even IS an AI Agent?" Explainer','Everyone says AI but most people mean chatbot. Here\'s the actual difference ğŸ‘‡','Slide 1: Chatbot vs Agent. Slide 2: Chatbot answers â€” Agent acts. Slide 3: Real Friday 5:30pm example. Slide 4: 3 agent components. Slide 5: CTA.','#AIAgents,#BusinessAutomation,#AIForBusiness') },
    { day:3, post: makePost('bts','Reel','Ryan & Max: Why We Started LHL','We kept seeing the same problem. Businesses drowning in work AI could handle.','Casual talking head, origin story, conversational. Show whiteboard + prototypes.','#Founders,#StartupStory,#SanDiego') },
    { day:4, post: makePost('pain','Reel','"Why Your Team Hates Monday Mornings"','It\'s not the meetings. It\'s the inbox full of stuff that piled up Friday at 5pm.','Relatable hook â†’ pivot to agent workflow solution. End with CTA.','#WorkLifeBalance,#SmallBusinessProblems,#AIHelp') },
    { day:6, post: makePost('social','Carousel','Diehl Group Architects Case Study','An architecture firm was spending hours transcribing site visits. We fixed that.','Problem â†’ what we built â†’ result â†’ quote â†’ CTA. 5 slides.','#ClientWin,#AIForArchitects,#BusinessAutomation') },
  ];
  calendar['0'] = {};
  defaults.forEach(({day, post}) => {
    calendar['0'][day] = [post];
  });
  saveCalendar(calendar);
}

function makePost(pillar, format, title, hook, body, hashtags) {
  return { id: crypto.randomUUID(), pillar, format, title, hook, body, hashtags };
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// EDIT STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let editState = {
  mode: 'add', // 'add' | 'edit'
  postId: null,
  week: null,
  day: null,
  fromIdea: null, // idea index if coming from sidebar
};

let detailState = { postId: null, week: null, day: null };

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RENDER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function getPillar(id) { return PILLARS.find(p => p.id === id) || PILLARS[0]; }

function renderPillarFilters() {
  const el = document.getElementById('pillarFilters');
  el.innerHTML = PILLARS.map(p => {
    const isActive = activePillars.has(p.id);
    const count = countPillarPosts(p.id);
    return `<button class="pillar-btn ${isActive ? 'active' : ''}" onclick="togglePillar('${p.id}')">
      <div class="pillar-dot" style="background:${p.color}"></div>
      ${p.label}
      <span class="pillar-count">${count}</span>
    </button>`;
  }).join('');
}

function countPillarPosts(pillarId) {
  let count = 0;
  Object.values(calendar).forEach(week => {
    Object.values(week).forEach(posts => {
      posts.forEach(p => { if (p.pillar === pillarId) count++; });
    });
  });
  return count;
}

function togglePillar(id) {
  if (activePillars.has(id)) activePillars.delete(id);
  else activePillars.add(id);
  renderPillarFilters();
  renderCalendar();
}

function renderCalendar() {
  document.getElementById('weekLabel').textContent = `Week ${currentWeek + 1}`;
  const weekKey = String(currentWeek);
  const weekData = calendar[weekKey] || {};
  const grid = document.getElementById('calGrid');

  grid.innerHTML = DAYS.map((day, i) => {
    const isRest = REST_DAYS.includes(i);
    if (isRest) return `<div class="cal-cell rest-cell"><div class="cell-day">${day}</div><div class="rest-day" style="flex:1;display:flex;align-items:center;justify-content:center;font-size:10px;color:var(--muted);font-family:'Space Mono',monospace;opacity:0.4">REST</div></div>`;

    const posts = (weekData[i] || []).filter(p => activePillars.has(p.pillar));

    return `<div class="cal-cell" id="cell-${i}"
      ondragover="onDragOver(event,${i})"
      ondrop="onDrop(event,${i})"
      ondragleave="onDragLeave(event,${i})">
      <div class="cell-day">
        <span>${day}</span>
        <button class="cell-add-btn" onclick="openAddModal(${currentWeek},${i})" title="Add post">+</button>
      </div>
      ${posts.map(p => renderPostPill(p, i)).join('')}
      ${posts.length === 0 ? `<div class="empty-slot" onclick="openAddModal(${currentWeek},${i})">+</div>` : ''}
    </div>`;
  }).join('');
}

function renderPostPill(post, dayIdx) {
  const pillar = getPillar(post.pillar);
  return `<div class="post-pill"
    style="background:${pillar.color}18; border-color:${pillar.color}33"
    onclick="openDetail('${post.id}',${currentWeek},${dayIdx})"
    draggable="true"
    ondragstart="onPillDragStart(event,'${post.id}',${dayIdx})">
    <div class="pill-actions">
      <button class="pill-action-btn" onclick="event.stopPropagation();openEditModal('${post.id}',${currentWeek},${dayIdx})" title="Edit">âœ</button>
      <button class="pill-action-btn del" onclick="event.stopPropagation();deletePost('${post.id}',${currentWeek},${dayIdx})" title="Delete">âœ•</button>
    </div>
    <div class="post-pill-format" style="color:${pillar.color}">${post.format}</div>
    <div class="post-pill-title">${post.title}</div>
  </div>`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DRAG & DROP
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let dragData = null; // { type: 'post'|'idea', id?, dayIdx?, ideaIdx? }

function onPillDragStart(e, postId, dayIdx) {
  dragData = { type: 'post', id: postId, dayIdx };
  e.dataTransfer.effectAllowed = 'move';
}

function onDragOver(e, dayIdx) {
  if (REST_DAYS.includes(dayIdx)) return;
  e.preventDefault();
  e.dataTransfer.dropEffect = 'move';
  document.getElementById(`cell-${dayIdx}`)?.classList.add('drop-target');
}

function onDragLeave(e, dayIdx) {
  document.getElementById(`cell-${dayIdx}`)?.classList.remove('drop-target');
}

function onDrop(e, dayIdx) {
  e.preventDefault();
  document.getElementById(`cell-${dayIdx}`)?.classList.remove('drop-target');
  if (!dragData) return;

  const weekKey = String(currentWeek);
  if (!calendar[weekKey]) calendar[weekKey] = {};

  if (dragData.type === 'post') {
    // Move post from one day to another
    const srcDay = String(dragData.dayIdx);
    const srcPosts = calendar[weekKey][srcDay] || [];
    const postIdx = srcPosts.findIndex(p => p.id === dragData.id);
    if (postIdx === -1) return;
    const [post] = srcPosts.splice(postIdx, 1);
    calendar[weekKey][srcDay] = srcPosts;
    if (!calendar[weekKey][String(dayIdx)]) calendar[weekKey][String(dayIdx)] = [];
    calendar[weekKey][String(dayIdx)].push(post);
    saveCalendar(calendar);
    renderCalendar();
    notify('Post moved!', 'success');
  } else if (dragData.type === 'idea') {
    const idea = IDEA_BANK[dragData.ideaIdx];
    if (!idea) return;
    const post = makePost(idea.pillar, idea.format, idea.title, idea.hook, idea.body, idea.hashtags);
    if (!calendar[weekKey][String(dayIdx)]) calendar[weekKey][String(dayIdx)] = [];
    calendar[weekKey][String(dayIdx)].push(post);
    saveCalendar(calendar);
    renderCalendar();
    renderPillarFilters();
    notify('Idea added to calendar!', 'success');
  }
  dragData = null;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// IDEA GENERATOR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function generateIdeas() {
  const pillarF = document.getElementById('genPillar').value;
  const formatF = document.getElementById('genFormat').value;

  let filtered = IDEA_BANK.filter((idea, i) => {
    const pm = pillarF === 'all' || idea.pillar === pillarF;
    const fm = formatF === 'all' || idea.format === formatF;
    return pm && fm;
  });

  // Shuffle, pick 5
  filtered = filtered.map((idea, i) => ({ idea, i: IDEA_BANK.indexOf(idea), r: Math.random() }))
    .sort((a, b) => a.r - b.r)
    .slice(0, 5);

  const list = document.getElementById('ideaList');
  list.innerHTML = filtered.map(({ idea, i }, idx) => {
    const pillar = getPillar(idea.pillar);
    return `<div class="idea-chip" style="animation-delay:${idx*0.06}s"
      draggable="true"
      ondragstart="onIdeaDragStart(event,${i})">
      <div class="idea-chip-type" style="color:${pillar.color}">${idea.format} Â· ${pillar.label}</div>
      <div class="idea-chip-title">${idea.title}</div>
      <div class="idea-chip-hook">${idea.hook.slice(0,80)}${idea.hook.length > 80 ? 'â€¦' : ''}</div>
      <button class="add-to-cal-btn" onclick="openAddFromIdea(${i})">+ Add to Calendar</button>
    </div>`;
  }).join('');
}

function onIdeaDragStart(e, ideaIdx) {
  dragData = { type: 'idea', ideaIdx };
  e.dataTransfer.effectAllowed = 'copy';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ADD / EDIT MODALS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function openAddModal(week, day) {
  editState = { mode: 'add', postId: null, week: week ?? currentWeek, day, fromIdea: null };
  document.getElementById('editTitle').textContent = 'Add Post';
  clearForm();
  if (day === null || day === undefined) showDayPicker();
  else hideDayPicker();
  document.getElementById('editOverlay').classList.add('open');
}

function openAddFromIdea(ideaIdx) {
  const idea = IDEA_BANK[ideaIdx];
  editState = { mode: 'add', postId: null, week: currentWeek, day: null, fromIdea: ideaIdx };
  document.getElementById('editTitle').textContent = 'Schedule Idea';
  fillForm(idea.pillar, idea.format, idea.title, idea.hook, idea.body, idea.hashtags);
  showDayPicker();
  document.getElementById('editOverlay').classList.add('open');
}

function openEditModal(postId, week, day) {
  const post = getPost(postId, week, day);
  if (!post) return;
  editState = { mode: 'edit', postId, week, day, fromIdea: null };
  document.getElementById('editTitle').textContent = 'Edit Post';
  fillForm(post.pillar, post.format, post.title, post.hook, post.body, post.hashtags);
  hideDayPicker();
  document.getElementById('editOverlay').classList.add('open');
}

function fillForm(pillar, format, title, hook, body, hashtags) {
  document.getElementById('fPillar').value = pillar || 'edu';
  document.getElementById('fFormat').value = format || 'Reel';
  document.getElementById('fTitle').value = title || '';
  document.getElementById('fHook').value = hook || '';
  document.getElementById('fBody').value = body || '';
  document.getElementById('fTags').value = hashtags || '';
}

function clearForm() { fillForm('edu','Reel','','','',''); }

function showDayPicker() {
  document.getElementById('dayPickerWrap').style.display = 'block';
  renderDayPicker();
}
function hideDayPicker() {
  document.getElementById('dayPickerWrap').style.display = 'none';
}

function renderDayPicker() {
  const weekKey = String(currentWeek);
  const weekData = calendar[weekKey] || {};
  const grid = document.getElementById('dayPickerGrid');

  // Header row
  let html = `<div></div>${DAYS.map(d => `<div class="day-picker-label">${d}</div>`).join('')}`;
  // 4 weeks
  for (let w = 0; w < 4; w++) {
    const wData = calendar[String(w)] || {};
    html += `<div class="week-row-label" style="font-family:'Space Mono',monospace;font-size:9px;color:var(--muted)">WK${w+1}</div>`;
    html += DAYS.map((d, i) => {
      const isRest = REST_DAYS.includes(i);
      const hasPosts = (wData[i] || []).length > 0;
      return `<button class="day-picker-btn ${hasPosts ? 'occupied' : ''}"
        ${isRest ? 'disabled' : ''}
        onclick="selectDay(${w},${i})"
        title="${isRest ? 'Rest day' : (hasPosts ? 'Has posts' : 'Empty')}"
        style="${!isRest && !hasPosts ? '' : ''}">
        ${isRest ? 'â€”' : (hasPosts ? 'â—' : d.slice(0,1))}
      </button>`;
    }).join('');
  }
  grid.innerHTML = html;
}

let selectedDay = null;
function selectDay(week, day) {
  editState.week = week;
  editState.day = day;
  selectedDay = { week, day };
  // Highlight
  document.querySelectorAll('.day-picker-btn').forEach(btn => btn.style.background = '');
  event.target.style.background = 'rgba(255,92,53,0.25)';
  event.target.style.borderColor = 'var(--accent)';
}

function savePost() {
  const title = document.getElementById('fTitle').value.trim();
  if (!title) { notify('Please add a title', 'error'); return; }

  const post = {
    id: editState.postId || crypto.randomUUID(),
    pillar: document.getElementById('fPillar').value,
    format: document.getElementById('fFormat').value,
    title,
    hook: document.getElementById('fHook').value.trim(),
    body: document.getElementById('fBody').value.trim(),
    hashtags: document.getElementById('fTags').value.trim(),
  };

  const week = String(editState.week ?? currentWeek);
  const day = editState.day;

  if (day === null || day === undefined) {
    notify('Please select a day first', 'error');
    return;
  }

  if (!calendar[week]) calendar[week] = {};
  if (!calendar[week][day]) calendar[week][day] = [];

  if (editState.mode === 'edit') {
    const posts = calendar[week][day];
    const idx = posts.findIndex(p => p.id === post.id);
    if (idx >= 0) posts[idx] = post;
    else posts.push(post);
  } else {
    calendar[week][day].push(post);
  }

  saveCalendar(calendar);
  closeOverlay('editOverlay');
  renderCalendar();
  renderPillarFilters();
  notify(editState.mode === 'edit' ? 'Post updated!' : 'Post added!', 'success');
}

function deletePost(postId, week, day) {
  const weekKey = String(week);
  if (!calendar[weekKey] || !calendar[weekKey][day]) return;
  calendar[weekKey][day] = calendar[weekKey][day].filter(p => p.id !== postId);
  saveCalendar(calendar);
  renderCalendar();
  renderPillarFilters();
  notify('Post deleted', 'success');
}

function getPost(postId, week, day) {
  const weekKey = String(week);
  return (calendar[weekKey]?.[day] || []).find(p => p.id === postId);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DETAIL MODAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function openDetail(postId, week, day) {
  const post = getPost(postId, week, day);
  if (!post) return;
  detailState = { postId, week, day };
  const pillar = getPillar(post.pillar);

  document.getElementById('detailTitle').textContent = post.title;
  document.getElementById('detailBody').innerHTML = `
    <div class="detail-label">Pillar Â· Format</div>
    <p style="color:${pillar.color};font-size:13px;margin-bottom:2px">${pillar.label} Â· ${post.format}</p>
    ${post.hook ? `<div class="detail-label">Hook</div><div class="detail-block">${post.hook}</div>` : ''}
    ${post.body ? `<div class="detail-label">Content Notes</div><p style="font-size:13px;line-height:1.7;color:var(--text2);margin-top:4px">${post.body}</p>` : ''}
    ${post.hashtags ? `<div class="detail-label">Hashtags</div><p style="font-family:'Space Mono',monospace;font-size:11px;color:var(--muted);margin-top:4px;line-height:1.8">${post.hashtags.split(',').map(t => t.trim()).join('  ')}</p>` : ''}
  `;
  document.getElementById('detailOverlay').classList.add('open');
}

function editFromDetail() {
  closeOverlay('detailOverlay');
  openEditModal(detailState.postId, detailState.week, detailState.day);
}

function copyCaption() {
  const post = getPost(detailState.postId, detailState.week, detailState.day);
  if (!post) return;
  const text = [post.hook, '', post.body, '', post.hashtags, '#LittleHammerLabs #AIAgents']
    .filter(Boolean).join('\n');
  navigator.clipboard.writeText(text).then(() => notify('Caption copied!', 'success')).catch(() => {});
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// WEEK NAV
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function changeWeek(dir) {
  currentWeek = (currentWeek + dir + 4) % 4;
  renderCalendar();
}

function confirmReset() {
  if (!confirm(`Reset Week ${currentWeek + 1}? This will delete all posts for this week.`)) return;
  delete calendar[String(currentWeek)];
  saveCalendar(calendar);
  renderCalendar();
  renderPillarFilters();
  notify('Week reset', 'success');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// EXPORT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function exportCSV() {
  const rows = [['Week','Day','Pillar','Format','Title','Hook','Notes','Hashtags']];
  for (let w = 0; w < 4; w++) {
    const weekData = calendar[String(w)] || {};
    DAYS.forEach((day, i) => {
      (weekData[i] || []).forEach(post => {
        rows.push([`Week ${w+1}`, day, getPillar(post.pillar).label, post.format,
          post.title, post.hook, post.body, post.hashtags]);
      });
    });
  }
  const csv = rows.map(r => r.map(cell => `"${(cell||'').replace(/"/g,'""')}"`).join(',')).join('\n');
  const blob = new Blob([csv], { type: 'text/csv' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href = url; a.download = 'lhl-content-calendar.csv'; a.click();
  URL.revokeObjectURL(url);
  notify('CSV exported!', 'success');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// HASHTAG BANK
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function renderHashtags() {
  const el = document.getElementById('hashtagGroups');
  el.innerHTML = HASHTAG_BANK.map(group => `
    <div style="min-width:160px">
      <h4 class="hashtag-group">${group.group}</h4>
      <div class="hashtag-tags">
        ${group.tags.map(t => `<span class="htag" onclick="copyHtag(this,'${t}')">${t}</span>`).join('')}
      </div>
    </div>
  `).join('');
}

function copyHtag(el, tag) {
  navigator.clipboard.writeText(tag).catch(() => {});
  const orig = el.textContent;
  el.textContent = 'âœ“';
  el.classList.add('copied');
  setTimeout(() => { el.textContent = orig; el.classList.remove('copied'); }, 1200);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// OVERLAYS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function closeOverlay(id, e) {
  if (e && e.target !== document.getElementById(id)) return;
  document.getElementById(id).classList.remove('open');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NOTIFY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

let notifyTimer;
function notify(msg, type = 'success') {
  const el = document.getElementById('notify');
  el.textContent = msg;
  el.className = `notify ${type} show`;
  clearTimeout(notifyTimer);
  notifyTimer = setTimeout(() => el.classList.remove('show'), 2500);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

seedDefaults();
renderPillarFilters();
renderCalendar();
renderHashtags();
</script>
</body>
</html>
